import{ab as S,j as m,f as s,n as l,bb as A,ad as P,aj as z,s as D,i as R,r as F,z as H,o as O,c as V,b as E,A as L,u as W,e as d,g as n,h as o,l as e,k as f,p as j,t as p,_ as M,F as T,x as X,aE as q,b9 as G,O as I}from"./index-D24HXhLT.js";import{_ as J}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DRN2bHzK.js";import{T as K}from"./TabButtons-C21neZP3.js";const Q={props:["to"],computed:{attributes(){return{...this.$attrs,target:this.isExternal?"_blank":null,to:this.isExternal?void 0:this.to,href:this.isExternal?this.to:void 0}},isExternal(){return this.to.startsWith("http")}}};function Y(k,b,c,h,i,u){return s(),m(z(u.isExternal?"a":"router-link"),P(u.attributes,{class:"cursor-pointer text-blue-500 hover:text-blue-600"}),{default:l(()=>[A(k.$slots,"default")]),_:3},16)}const Z=S(Q,[["render",Y]]),ee={class:"sticky top-0 z-10 flex flex-col md:flex-row md:items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},te={class:"flex items-center space-x-2"},ae={class:"w-3/4 mx-auto px-5 pt-6 divide-y"},se={class:"flex items-center py-2 justify-between"},ne={class:"flex items-center"},ie=["innerHTML"],re={class:"flex items-center space-x-2"},oe={key:1,class:"text-ink-gray-5"},de={__name:"Notifications",setup(k){var g,N;const{brand:b}=D(),c=R("$user"),h=R("$socket"),i=F("Unread"),u=H();O(()=>{c.data||u.push({name:"Courses"}),h.on("publish_lms_notifications",t=>{r.reload()})});const x=E(()=>i.value==="Unread"?r.data:_.data),r=V({doctype:"Notification Log",url:"lms.lms.api.get_notifications",filters:{for_user:(g=c.data)==null?void 0:g.name,read:0},auto:!0,cache:"Unread Notifications"}),_=V({doctype:"Notification Log",url:"lms.lms.api.get_notifications",filters:{for_user:(N=c.data)==null?void 0:N.name,read:1},auto:!0,cache:"Read Notifications"}),v=L({url:"lms.lms.api.mark_as_read",makeParams(t){return{name:t.name}},onSuccess(t){r.reload(),_.reload()}}),y=L({url:"lms.lms.api.mark_all_as_read",onSuccess(t){r.reload(),_.reload()}}),U=E(()=>[{label:"Notifications",route:{name:"Notifications"}}]);return W(()=>({title:"Notifications",icon:b.favicon})),(t,$)=>{var C,w;return s(),d(T,null,[n("header",ee,[o(e(J),{items:U.value},null,8,["items"]),n("div",te,[i.value==="Unread"&&((C=e(r).data)==null?void 0:C.length)>0?(s(),m(e(M),{key:0,onClick:e(y).submit,loading:e(y).loading},{default:l(()=>[j(p(t.__("Mark all as read")),1)]),_:1},8,["onClick","loading"])):f("",!0),o(e(K),{class:"inline-block",buttons:[{label:"Unread",active:!0},{label:"Read"}],modelValue:i.value,"onUpdate:modelValue":$[0]||($[0]=a=>i.value=a)},null,8,["modelValue"])])]),n("div",ae,[(w=x.value)!=null&&w.length?(s(!0),d(T,{key:0},X(x.value,a=>(s(),d("div",se,[n("div",ne,[o(e(q),{image:a.user_image,label:a.full_name,class:"mr-2"},null,8,["image","label"]),n("div",{class:"notification text-ink-gray-7",innerHTML:a.subject},null,8,ie)]),n("div",re,[a.link?(s(),m(e(Z),{key:0,to:a.link,onClick:B=>e(v).submit({name:a.name}),class:"text-ink-gray-5 font-medium text-sm hover:text-ink-gray-7"},{default:l(()=>[j(p(t.__("View")),1)]),_:2},1032,["to","onClick"])):f("",!0),o(e(I),{text:t.__("Mark as read")},{default:l(()=>[a.read?f("",!0):(s(),m(e(M),{key:0,variant:"ghost",onClick:B=>e(v).submit({name:a.name})},{icon:l(()=>[o(e(G),{class:"h-4 w-4 text-ink-gray-7 stroke-1.5"})]),_:2},1032,["onClick"]))]),_:2},1032,["text"])])]))),256)):(s(),d("div",oe,p(t.__("Nothing to see here.")),1))])],64)}}};export{de as default};
//# sourceMappingURL=Notifications-D-ZXrDSv.js.map
