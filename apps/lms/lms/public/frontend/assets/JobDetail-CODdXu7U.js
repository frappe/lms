import{J as q,r as B,K as N,i as A,A as V,j as k,f as u,n as i,g as s,e as f,t as n,h as l,l as e,b6 as H,_ as h,p as m,b7 as D,b8 as E,M as O,H as R,s as W,u as Y,d as K,k as M,bQ as Q,bR as G,bS as I,bl as X,B as C,bT as Z,bU as ee,bV as te,N as ae}from"./index-D24HXhLT.js";import{_ as se}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DRN2bHzK.js";const oe={class:"flex flex-col gap-4"},ie={key:0},le={class:""},ne={key:1,class:"flex items-center"},re={class:"border rounded-md p-2 mr-2"},de={class:"flex flex-col"},pe={class:"text-sm text-ink-gray-4 mt-1"},ce={__name:"JobApplicationModal",props:q({job:{type:String,required:!0}},{modelValue:{},modelModifiers:{},application:{},applicationModifiers:{}}),emits:["update:modelValue","update:application"],setup(y){const c=B(null),x=N(y,"modelValue"),z=A("$user"),v=N(y,"application"),w=y,j=p=>{if(p.name.split(".").pop().toLowerCase()!="pdf")return"Only PDF file is allowed"},a=V({url:"frappe.client.insert",makeParams(p){var d,r;return{doc:{doctype:"LMS Job Application",user:(d=z.data)==null?void 0:d.name,resume:(r=c.value)==null?void 0:r.file_name,job:w.job}}}}),b=p=>{a.submit({},{validate(){if(!c.value)return"Please upload your resume"},onSuccess(){R.success("Your application has been submitted successfully"),v.value.reload(),p()},onError(d){var r;R.error(((r=d.messages)==null?void 0:r[0])||d)}})};return(p,d)=>(u(),k(e(O),{modelValue:x.value,"onUpdate:modelValue":d[1]||(d[1]=r=>x.value=r),class:"text-base",options:{title:p.__("Apply for this job"),size:"lg",actions:[{label:"Submit",variant:"solid",onClick:r=>{b(r)}}]}},{"body-content":i(()=>[s("div",oe,[s("p",null,n(p.__("Submit your resume to proceed with your application for this position. Upon submission, it will be shared with the job poster.")),1),c.value?(u(),f("div",ne,[s("div",re,[l(e(D),{class:"h-5 w-5 stroke-1.5 text-ink-gray-7"})]),s("div",de,[s("span",null,n(c.value.file_name),1),s("span",pe,n(e(E)(c.value.file_size)),1)])])):(u(),f("div",ie,[l(e(H),{fileTypes:[".pdf"],validateFile:j,onSuccess:d[0]||(d[0]=r=>{c.value=r})},{default:i(({file:r,progress:$,uploading:o,openFileSelector:t})=>[s("div",le,[l(e(h),{onClick:t,loading:o},{default:i(()=>[m(n(o?`Uploading ${$}%`:"Upload your resume"),1)]),_:2},1032,["onClick","loading"])])]),_:1})]))])]),_:1},8,["modelValue","options"]))}},ue={class:""},me={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},be={key:0,class:"flex items-center space-x-2"},_e={key:1},fe={key:0,class:"max-w-3xl mx-auto pt-5"},ye={class:"p-4"},ve={class:"space-y-5 mb-12"},ge={class:"flex"},ke=["src","alt"],he={class:""},xe={class:"text-2xl text-ink-gray-9 font-semibold mb-1"},we={class:"text-sm text-ink-gray-5 font-semibold"},je={class:"space-x-5"},$e={class:"flex items-center justify-between"},Se=["innerHTML"],Ve={__name:"JobDetail",props:{job:{type:String,required:!0}},setup(y){const c=A("$user"),x=A("$dayjs"),{brand:z}=W(),v=B(!1),w=window.read_only_mode,j=y,a=V({url:"lms.lms.api.get_job_details",params:{job:j.job},cache:["job",j.job],auto:!0,onSuccess:o=>{var t;(t=c.data)!=null&&t.name&&b.submit(),p.submit()}}),b=V({url:"frappe.client.get_list",makeParams(o){var t,S;return{doctype:"LMS Job Application",filters:{job:(t=a.data)==null?void 0:t.name,user:(S=c.data)==null?void 0:S.name}}}}),p=V({url:"frappe.client.get_count",makeParams(o){var t;return{doctype:"LMS Job Application",filters:{job:(t=a.data)==null?void 0:t.name}}}}),d=()=>{v.value=!0},r=o=>{window.location.href=`/login?redirect-to=/job-openings/${o}`},$=o=>{window.open(o,"_blank")};return Y(()=>{var o;return{title:(o=a.data)==null?void 0:o.job_title,icon:z.favicon}}),(o,t)=>{var J,U,T,L,P,F;const S=K("router-link");return u(),f("div",ue,[s("header",me,[l(e(se),{class:"h-7",items:[{label:o.__("Jobs"),route:{name:"Jobs"}},{label:(J=e(a).data)==null?void 0:J.job_title,route:{name:"JobDetail",params:{job:(U=e(a).data)==null?void 0:U.name}}}]},null,8,["items"]),(T=e(c).data)!=null&&T.name&&!e(w)?(u(),f("div",be,[e(c).data.name==((L=e(a).data)==null?void 0:L.owner)?(u(),k(S,{key:0,to:{name:"JobForm",params:{jobName:(P=e(a).data)==null?void 0:P.name}}},{default:i(()=>[l(e(h),null,{prefix:i(()=>[l(e(Q),{class:"h-4 w-4 stroke-1.5"})]),default:i(()=>[m(" "+n(o.__("Edit")),1)]),_:1})]),_:1},8,["to"])):M("",!0),l(e(h),{onClick:t[0]||(t[0]=_=>{var g;return $((g=e(a).data)==null?void 0:g.company_website)})},{prefix:i(()=>[l(e(G),{class:"h-4 w-4 stroke-1.5"})]),default:i(()=>[m(" "+n(o.__("Visit Website")),1)]),_:1}),(F=e(b).data)!=null&&F.length?(u(),k(e(C),{key:2,variant:"subtle",theme:"green",size:"lg"},{prefix:i(()=>[l(e(X),{class:"h-4 w-4"})]),default:i(()=>[m(" "+n(o.__("You have applied")),1)]),_:1})):(u(),k(e(h),{key:1,variant:"solid",onClick:t[1]||(t[1]=_=>d())},{prefix:i(()=>[l(e(I),{class:"h-4 w-4"})]),default:i(()=>[m(" "+n(o.__("Apply")),1)]),_:1}))])):e(w)?M("",!0):(u(),f("div",_e,[l(e(h),{onClick:t[2]||(t[2]=_=>{var g;return r((g=e(a).data)==null?void 0:g.name)})},{default:i(()=>[s("span",null,n(o.__("Login to apply")),1)]),_:1})]))]),e(a).data?(u(),f("div",fe,[s("div",ye,[s("div",ve,[s("div",ge,[s("img",{src:e(a).data.company_logo,class:"size-10 rounded-lg object-contain cursor-pointer mr-4",alt:e(a).data.company_name,onClick:t[3]||(t[3]=_=>$(e(a).data.company_website))},null,8,ke),s("div",he,[s("div",xe,n(e(a).data.job_title),1),s("div",we,n(e(a).data.company_name)+" - "+n(e(a).data.location)+", "+n(e(a).data.country),1)])]),s("div",je,[l(e(C),{size:"lg"},{prefix:i(()=>[l(e(Z),{class:"size-3 stroke-2 text-ink-gray-7"})]),default:i(()=>[m(" "+n(e(x)(e(a).data.creation).fromNow()),1)]),_:1}),l(e(C),{size:"lg"},{prefix:i(()=>[l(e(ee),{class:"size-3 stroke-2 text-ink-gray-7"})]),default:i(()=>[m(" "+n(e(a).data.type),1)]),_:1}),e(p).data?(u(),k(e(C),{key:0,size:"lg"},{prefix:i(()=>[l(e(te),{class:"size-3 stroke-2 text-ink-gray-7"})]),default:i(()=>[m(" "+n(e(p).data)+" "+n(e(p).data==1?o.__("applicant"):o.__("applicants")),1)]),_:1})):M("",!0)])]),s("div",$e,[t[6]||(t[6]=s("div",{class:"bg-surface-gray-2 h-px m-1 w-1/2"},null,-1)),s("div",null,[l(e(D),{class:"size-3 stroke-1 text-ink-gray-5"})]),t[7]||(t[7]=s("div",{class:"bg-surface-gray-2 h-px m-1 w-1/2"},null,-1))]),s("p",{innerHTML:e(a).data.description,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal mt-12"},null,8,Se)]),l(ce,{modelValue:v.value,"onUpdate:modelValue":t[4]||(t[4]=_=>v.value=_),application:e(b),"onUpdate:application":t[5]||(t[5]=_=>ae(b)?b.value=_:null),job:e(a).data.name},null,8,["modelValue","application","job"])])):M("",!0)])}}};export{Ve as default};
//# sourceMappingURL=JobDetail-CODdXu7U.js.map
