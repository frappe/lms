{"version":3,"file":"JobDetail-CODdXu7U.js","sources":["../../../../frontend/src/components/Modals/JobApplicationModal.vue","../../../../frontend/src/pages/JobDetail.vue"],"sourcesContent":["<template>\n\t<Dialog\n\t\tv-model=\"show\"\n\t\tclass=\"text-base\"\n\t\t:options=\"{\n\t\t\ttitle: __('Apply for this job'),\n\t\t\tsize: 'lg',\n\t\t\tactions: [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Submit',\n\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\tonClick: (close) => {\n\t\t\t\t\t\tsubmitResume(close)\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t}\"\n\t>\n\t\t<template #body-content>\n\t\t\t<div class=\"flex flex-col gap-4\">\n\t\t\t\t<p>\n\t\t\t\t\t{{\n\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t'Submit your resume to proceed with your application for this position. Upon submission, it will be shared with the job poster.'\n\t\t\t\t\t\t)\n\t\t\t\t\t}}\n\t\t\t\t</p>\n\t\t\t\t<div v-if=\"!resume\">\n\t\t\t\t\t<FileUploader\n\t\t\t\t\t\t:fileTypes=\"['.pdf']\"\n\t\t\t\t\t\t:validateFile=\"validateFile\"\n\t\t\t\t\t\t@success=\"\n\t\t\t\t\t\t\t(file) => {\n\t\t\t\t\t\t\t\tresume = file\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template v-slot=\"{ file, progress, uploading, openFileSelector }\">\n\t\t\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t\t\t<Button @click=\"openFileSelector\" :loading=\"uploading\">\n\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\tuploading ? `Uploading ${progress}%` : 'Upload your resume'\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</FileUploader>\n\t\t\t\t</div>\n\t\t\t\t<div v-else class=\"flex items-center\">\n\t\t\t\t\t<div class=\"border rounded-md p-2 mr-2\">\n\t\t\t\t\t\t<FileText class=\"h-5 w-5 stroke-1.5 text-ink-gray-7\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex flex-col\">\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{{ resume.file_name }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"text-sm text-ink-gray-4 mt-1\">\n\t\t\t\t\t\t\t{{ getFileSize(resume.file_size) }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n<script setup>\nimport { Dialog, FileUploader, Button, createResource, toast } from 'frappe-ui'\nimport { FileText } from 'lucide-vue-next'\nimport { ref, inject } from 'vue'\nimport { getFileSize } from '@/utils/'\n\nconst resume = ref(null)\nconst show = defineModel()\nconst user = inject('$user')\nconst application = defineModel('application')\n\nconst props = defineProps({\n\tjob: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst validateFile = (file) => {\n\tlet extension = file.name.split('.').pop().toLowerCase()\n\tif (extension != 'pdf') {\n\t\treturn 'Only PDF file is allowed'\n\t}\n}\n\nconst jobApplication = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'LMS Job Application',\n\t\t\t\tuser: user.data?.name,\n\t\t\t\tresume: resume.value?.file_name,\n\t\t\t\tjob: props.job,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst submitResume = (close) => {\n\tjobApplication.submit(\n\t\t{},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\tif (!resume.value) {\n\t\t\t\t\treturn 'Please upload your resume'\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSuccess() {\n\t\t\t\ttoast.success('Your application has been submitted successfully')\n\t\t\t\tapplication.value.reload()\n\t\t\t\tclose()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t},\n\t\t}\n\t)\n}\n</script>\n","<template>\n\t<div class=\"\">\n\t\t<header\n\t\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n\t\t>\n\t\t\t<Breadcrumbs\n\t\t\t\tclass=\"h-7\"\n\t\t\t\t:items=\"[\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: __('Jobs'),\n\t\t\t\t\t\troute: { name: 'Jobs' },\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: job.data?.job_title,\n\t\t\t\t\t\troute: { name: 'JobDetail', params: { job: job.data?.name } },\n\t\t\t\t\t},\n\t\t\t\t]\"\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tv-if=\"user.data?.name && !readOnlyMode\"\n\t\t\t\tclass=\"flex items-center space-x-2\"\n\t\t\t>\n\t\t\t\t<router-link\n\t\t\t\t\tv-if=\"user.data.name == job.data?.owner\"\n\t\t\t\t\t:to=\"{\n\t\t\t\t\t\tname: 'JobForm',\n\t\t\t\t\t\tparams: { jobName: job.data?.name },\n\t\t\t\t\t}\"\n\t\t\t\t>\n\t\t\t\t\t<Button>\n\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t<Pencil class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t{{ __('Edit') }}\n\t\t\t\t\t</Button>\n\t\t\t\t</router-link>\n\t\t\t\t<Button @click=\"redirectToWebsite(job.data?.company_website)\">\n\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t<SquareArrowOutUpRight class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ __('Visit Website') }}\n\t\t\t\t</Button>\n\t\t\t\t<Button\n\t\t\t\t\tv-if=\"!jobApplication.data?.length\"\n\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t@click=\"openApplicationModal()\"\n\t\t\t\t>\n\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t<SendHorizonal class=\"h-4 w-4\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ __('Apply') }}\n\t\t\t\t</Button>\n\t\t\t\t<Badge v-else variant=\"subtle\" theme=\"green\" size=\"lg\">\n\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t<Check class=\"h-4 w-4\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ __('You have applied') }}\n\t\t\t\t</Badge>\n\t\t\t</div>\n\t\t\t<div v-else-if=\"!readOnlyMode\">\n\t\t\t\t<Button @click=\"redirectToLogin(job.data?.name)\">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{{ __('Login to apply') }}\n\t\t\t\t\t</span>\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t</header>\n\t\t<div v-if=\"job.data\" class=\"max-w-3xl mx-auto pt-5\">\n\t\t\t<div class=\"p-4\">\n\t\t\t\t<div class=\"space-y-5 mb-12\">\n\t\t\t\t\t<div class=\"flex\">\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t:src=\"job.data.company_logo\"\n\t\t\t\t\t\t\tclass=\"size-10 rounded-lg object-contain cursor-pointer mr-4\"\n\t\t\t\t\t\t\t:alt=\"job.data.company_name\"\n\t\t\t\t\t\t\t@click=\"redirectToWebsite(job.data.company_website)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t\t<div class=\"text-2xl text-ink-gray-9 font-semibold mb-1\">\n\t\t\t\t\t\t\t\t{{ job.data.job_title }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"text-sm text-ink-gray-5 font-semibold\">\n\t\t\t\t\t\t\t\t{{ job.data.company_name }} - {{ job.data.location }},\n\t\t\t\t\t\t\t\t{{ job.data.country }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"space-x-5\">\n\t\t\t\t\t\t<Badge size=\"lg\">\n\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t<CalendarDays class=\"size-3 stroke-2 text-ink-gray-7\" />\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t{{ dayjs(job.data.creation).fromNow() }}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t<Badge size=\"lg\">\n\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t<ClipboardType class=\"size-3 stroke-2 text-ink-gray-7\" />\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t{{ job.data.type }}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t<Badge v-if=\"applicationCount.data\" size=\"lg\">\n\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t<SquareUserRound class=\"size-3 stroke-2 text-ink-gray-7\" />\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t{{ applicationCount.data }}\n\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\tapplicationCount.data == 1 ? __('applicant') : __('applicants')\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"flex items-center justify-between\">\n\t\t\t\t\t<div class=\"bg-surface-gray-2 h-px m-1 w-1/2\"></div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<FileText class=\"size-3 stroke-1 text-ink-gray-5\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bg-surface-gray-2 h-px m-1 w-1/2\"></div>\n\t\t\t\t</div>\n\n\t\t\t\t<p\n\t\t\t\t\tv-html=\"job.data.description\"\n\t\t\t\t\tclass=\"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal mt-12\"\n\t\t\t\t></p>\n\t\t\t</div>\n\t\t\t<JobApplicationModal\n\t\t\t\tv-model=\"showApplicationModal\"\n\t\t\t\tv-model:application=\"jobApplication\"\n\t\t\t\t:job=\"job.data.name\"\n\t\t\t/>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tBadge,\n\tButton,\n\tBreadcrumbs,\n\tcreateResource,\n\tusePageMeta,\n} from 'frappe-ui'\nimport { inject, ref } from 'vue'\nimport { sessionStore } from '../stores/session'\nimport JobApplicationModal from '@/components/Modals/JobApplicationModal.vue'\nimport {\n\tCheck,\n\tSendHorizonal,\n\tPencil,\n\tCalendarDays,\n\tSquareUserRound,\n\tSquareArrowOutUpRight,\n\tFileText,\n\tClipboardType,\n} from 'lucide-vue-next'\n\nconst user = inject('$user')\nconst dayjs = inject('$dayjs')\nconst { brand } = sessionStore()\nconst showApplicationModal = ref(false)\nconst readOnlyMode = window.read_only_mode\n\nconst props = defineProps({\n\tjob: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst job = createResource({\n\turl: 'lms.lms.api.get_job_details',\n\tparams: {\n\t\tjob: props.job,\n\t},\n\tcache: ['job', props.job],\n\tauto: true,\n\tonSuccess: (data) => {\n\t\tif (user.data?.name) {\n\t\t\tjobApplication.submit()\n\t\t}\n\t\tapplicationCount.submit()\n\t},\n})\n\nconst jobApplication = createResource({\n\turl: 'frappe.client.get_list',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'LMS Job Application',\n\t\t\tfilters: {\n\t\t\t\tjob: job.data?.name,\n\t\t\t\tuser: user.data?.name,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst applicationCount = createResource({\n\turl: 'frappe.client.get_count',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'LMS Job Application',\n\t\t\tfilters: {\n\t\t\t\tjob: job.data?.name,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst openApplicationModal = () => {\n\tshowApplicationModal.value = true\n}\n\nconst redirectToLogin = (job) => {\n\twindow.location.href = `/login?redirect-to=/job-openings/${job}`\n}\n\nconst redirectToWebsite = (url) => {\n\twindow.open(url, '_blank')\n}\n\nusePageMeta(() => {\n\treturn {\n\t\ttitle: job.data?.job_title,\n\t\ticon: brand.favicon,\n\t}\n})\n</script>\n<style>\np {\n\tmargin-bottom: 0.5rem !important;\n\tline-height: 1.5;\n}\np span {\n\tline-height: 1.5;\n}\n</style>\n"],"names":["resume","ref","show","_useModel","__props","user","inject","application","props","validateFile","file","jobApplication","createResource","values","_a","_b","submitResume","close","toast","err","dayjs","brand","sessionStore","showApplicationModal","readOnlyMode","job","data","applicationCount","openApplicationModal","redirectToLogin","redirectToWebsite","url","usePageMeta"],"mappings":"uwBAuEA,MAAMA,EAASC,EAAI,IAAI,EACjBC,EAAOC,EAAYC,EAAA,YAAA,EACnBC,EAAOC,EAAO,OAAO,EACrBC,EAAcJ,EAAYC,EAAA,aAAa,EAEvCI,EAAQJ,EAORK,EAAgBC,GAAS,CAE9B,GADgBA,EAAK,KAAK,MAAM,GAAG,EAAE,IAAG,EAAG,YAAW,GACrC,MAChB,MAAO,0BAET,EAEMC,EAAiBC,EAAe,CACrC,IAAK,uBACL,WAAWC,EAAQ,SAClB,MAAO,CACN,IAAK,CACJ,QAAS,sBACT,MAAMC,EAAAT,EAAK,OAAL,YAAAS,EAAW,KACjB,QAAQC,EAAAf,EAAO,QAAP,YAAAe,EAAc,UACtB,IAAKP,EAAM,GACX,CACJ,CACE,CACF,CAAC,EAEKQ,EAAgBC,GAAU,CAC/BN,EAAe,OACd,CAAE,EACF,CACC,UAAW,CACV,GAAI,CAACX,EAAO,MACX,MAAO,2BAER,EACD,WAAY,CACXkB,EAAM,QAAQ,kDAAkD,EAChEX,EAAY,MAAM,OAAM,EACxBU,EAAK,CACL,EACD,QAAQE,EAAK,OACZD,EAAM,QAAMJ,EAAAK,EAAI,WAAJ,YAAAL,EAAe,KAAMK,CAAG,CACpC,CACJ,CACA,CACA,2gDCiCA,MAAMd,EAAOC,EAAO,OAAO,EACrBc,EAAQd,EAAO,QAAQ,EACvB,CAAE,MAAAe,CAAO,EAAGC,EAAY,EACxBC,EAAuBtB,EAAI,EAAK,EAChCuB,EAAe,OAAO,eAEtBhB,EAAQJ,EAORqB,EAAMb,EAAe,CAC1B,IAAK,8BACL,OAAQ,CACP,IAAKJ,EAAM,GACX,EACD,MAAO,CAAC,MAAOA,EAAM,GAAG,EACxB,KAAM,GACN,UAAYkB,GAAS,QAChBZ,EAAAT,EAAK,OAAL,MAAAS,EAAW,MACdH,EAAe,OAAM,EAEtBgB,EAAiB,OAAM,CACvB,CACF,CAAC,EAEKhB,EAAiBC,EAAe,CACrC,IAAK,yBACL,WAAWC,EAAQ,SAClB,MAAO,CACN,QAAS,sBACT,QAAS,CACR,KAAKC,EAAAW,EAAI,OAAJ,YAAAX,EAAU,KACf,MAAMC,EAAAV,EAAK,OAAL,YAAAU,EAAW,IACjB,CACJ,CACE,CACF,CAAC,EAEKY,EAAmBf,EAAe,CACvC,IAAK,0BACL,WAAWC,EAAQ,OAClB,MAAO,CACN,QAAS,sBACT,QAAS,CACR,KAAKC,EAAAW,EAAI,OAAJ,YAAAX,EAAU,IACf,CACJ,CACE,CACF,CAAC,EAEKc,EAAuB,IAAM,CAClCL,EAAqB,MAAQ,EAC9B,EAEMM,EAAmBJ,GAAQ,CAChC,OAAO,SAAS,KAAO,oCAAoCA,CAAG,EAC/D,EAEMK,EAAqBC,GAAQ,CAClC,OAAO,KAAKA,EAAK,QAAQ,CAC1B,EAEA,OAAAC,EAAY,IAAM,OACjB,MAAO,CACN,OAAOlB,EAAAW,EAAI,OAAJ,YAAAX,EAAU,UACjB,KAAMO,EAAM,OACd,CACA,CAAC"}