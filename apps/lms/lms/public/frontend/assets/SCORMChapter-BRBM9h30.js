import{s as x,a4 as y,i as P,r as T,a5 as V,a6 as D,c as R,A as I,b as k,u as A,e as l,f as i,g as c,k as B,h as v,l as a,t as C,n as F,p as z,_ as j,F as q,a as O}from"./index-D24HXhLT.js";import{_ as Y}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DRN2bHzK.js";const H={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},J={key:0},K=["src"],Q={key:1},U={class:"text-center pt-10 px-5 md:px-0 pb-10"},W={class:"text-center"},X={class:"mb-4"},te={__name:"SCORMChapter",props:{courseName:{type:String,required:!0},chapterName:{type:String,required:!0}},setup(L){var S,h;const{brand:M}=x(),N=y(),o=P("$user"),m=T(!1),r=L;V(()=>{N.isSidebarCollapsed=!0,G()});const t=D({doctype:"Course Chapter",name:r.chapterName,auto:!0,cache:["chapter",r.chapterName],onSuccess(e){_.submit()}}),u=R({doctype:"LMS Enrollment",fields:["member","course"],filters:{course:r.courseName,member:(S=o.data)==null?void 0:S.name},auto:!0,cache:["enrollments",r.courseName,(h=o.data)==null?void 0:h.name]}),d=e=>{var s;return e=="cmi.core.lesson_status"?((s=_.data)==null?void 0:s.status)=="Complete"?"passed":"incomplete":""},p=(e,s)=>{e=="cmi.core.lesson_status"&&s=="passed"&&w()},w=()=>{O("lms.lms.doctype.course_lesson.course_lesson.save_progress",{lesson:t.doc.lessons[0].lesson,course:r.courseName})},_=I({url:"frappe.client.get_value",makeParams(e){var s,n;return{doctype:"LMS Course Progress",fieldname:"status",filters:{member:(s=o.data)==null?void 0:s.name,lesson:t.doc.lessons[0].lesson,chapter:t.doc.name,course:(n=t.doc)==null?void 0:n.course}}},onSuccess(e){m.value=!0}}),E=()=>{var e;u.insert.submit({course:r.courseName,member:(e=o.data)==null?void 0:e.name},{onSuccess(s){window.location.reload()}})},G=()=>{window.API_1484_11={Initialize:()=>"true",Terminate:()=>"true",GetValue:e=>(console.log(`GET: ${e}`),d(e)),SetValue:(e,s)=>(console.log(`SET: ${e} to value: ${s}`),p(e,s),"true"),Commit:()=>"true",GetLastError:()=>"0",GetErrorString:()=>"",GetDiagnostic:()=>""},window.API={LMSInitialize:()=>"true",LMSFinish:()=>"true",LMSGetValue:e=>(console.log(`GET: ${e}`),d(e)),LMSSetValue:(e,s)=>(console.log(`SET: ${e} to value: ${s}`),p(e,s),"true"),LMSCommit:()=>"true",LMSGetLastError:()=>"0",LMSGetErrorString:()=>"",LMSGetDiagnostic:()=>""}},$=k(()=>{var e,s;return[{label:"Courses",route:{name:"Courses"}},{label:(e=t.doc)==null?void 0:e.course_title,route:{name:"CourseDetail",params:{courseName:r.courseName}}},{label:(s=t.doc)==null?void 0:s.title}]});return A(()=>{var e;return{title:(e=t.doc)==null?void 0:e.title,icon:M.favicon}}),(e,s)=>{var n,f,g,b;return i(),l(q,null,[c("header",H,[v(a(Y),{class:"h-7",items:$.value},null,8,["items"])]),m.value&&((n=a(u).data)!=null&&n.length||(f=a(o).data)!=null&&f.is_moderator||(g=a(o).data)!=null&&g.is_instructor)?(i(),l("div",J,[c("iframe",{src:a(t).doc.launch_file,class:"w-full h-screen"},null,8,K)])):(b=a(u).data)!=null&&b.length?B("",!0):(i(),l("div",Q,[c("div",U,[c("div",W,[c("div",X,C(e.__("You are not enrolled in this course. Please enroll to access this lesson.")),1),v(a(j),{variant:"solid",onClick:s[0]||(s[0]=Z=>E())},{default:F(()=>[z(C(e.__("Start Learning")),1)]),_:1})])])]))],64)}}};export{te as default};
//# sourceMappingURL=SCORMChapter-BRBM9h30.js.map
