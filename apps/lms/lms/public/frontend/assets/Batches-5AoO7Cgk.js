import{e as d,f as o,g as u,k as v,t as c,p as F,h as f,l as s,a7 as Z,a8 as L,a9 as ee,F as M,x as P,j as x,C as te,i as j,s as ae,r as h,b as Y,o as le,c as se,w as oe,u as ne,d as re,n as B,_ as T,P as ie,q as N,v as ue}from"./index-D24HXhLT.js";import{_ as ce}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DRN2bHzK.js";import{T as de}from"./TabButtons-C21neZP3.js";import{_ as me}from"./DateRange-DeTK-VK6.js";import{_ as fe}from"./CourseInstructors-AYbj4319.js";import{_ as ve}from"./UserAvatar-CNqvj4u9.js";import{_ as he}from"./EmptyState.vue_vue_type_script_setup_true_lang-_-SuznPy.js";const ge={class:"flex flex-col border hover:border-outline-gray-4 rounded-md p-4 h-full",style:{"min-height":"150px"}},_e={class:"text-lg leading-5 font-semibold mb-2 text-ink-gray-9"},be={key:0,class:"text-xs bg-green-100 text-green-700 self-start px-2 py-0.5 rounded-md"},ye={key:0},pe={key:1},xe={key:1,class:"text-xs bg-red-100 text-red-700 self-start px-2 py-0.5 rounded-md"},ke={class:"short-introduction text-sm text-ink-gray-7"},$e={key:2,class:"font-semibold text-ink-gray-9 mb-4"},we={class:"flex flex-col space-y-2 mt-auto"},Be={class:"flex items-center text-sm text-ink-gray-7"},Ce={key:0,class:"flex items-center text-sm text-ink-gray-7"},Ve={key:3,class:"flex avatar-group overlap mt-4"},Se={__name:"BatchCard",props:{batch:{type:Object,default:null}},setup(a){return(n,C)=>{var V;return o(),d("div",ge,[u("div",_e,c(a.batch.title),1),a.batch.seat_count&&a.batch.seats_left>0?(o(),d("div",be,[F(c(a.batch.seats_left)+" ",1),a.batch.seats_left>1?(o(),d("span",ye,c(n.__("Seats Left")),1)):a.batch.seats_left==1?(o(),d("span",pe,c(n.__("Seat Left")),1)):v("",!0)])):a.batch.seat_count&&a.batch.seats_left<=0?(o(),d("div",xe,c(n.__("Sold Out")),1)):v("",!0),u("div",ke,c(a.batch.description),1),a.batch.amount?(o(),d("div",$e,c(a.batch.price),1)):v("",!0),u("div",we,[f(me,{startDate:a.batch.start_date,endDate:a.batch.end_date,class:"text-sm text-ink-gray-7"},null,8,["startDate","endDate"]),u("div",Be,[f(s(Z),{class:"h-4 w-4 stroke-1.5 mr-2 text-ink-gray-7"}),u("span",null,c(s(L)(a.batch.start_time))+" - "+c(s(L)(a.batch.end_time)),1)]),a.batch.timezone?(o(),d("div",Ce,[f(s(ee),{class:"h-4 w-4 stroke-1.5 mr-2 text-ink-gray-5"}),u("span",null,c(a.batch.timezone),1)])):v("",!0)]),(V=a.batch.instructors)!=null&&V.length?(o(),d("div",Ve,[u("div",{class:te(["h-6 mr-1",{"avatar-group overlap":a.batch.instructors.length>1}])},[(o(!0),d(M,null,P(a.batch.instructors,D=>(o(),x(ve,{user:D},null,8,["user"]))),256))],2),f(fe,{instructors:a.batch.instructors},null,8,["instructors"])])):v("",!0)])}}},De={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},Ye={class:"p-5 pb-10"},Fe={class:"flex flex-col lg:flex-row space-y-4 lg:space-y-0 lg:items-center justify-between mb-5"},Me={class:"text-lg text-ink-gray-9 font-semibold"},Ue={class:"flex flex-col space-y-2 lg:space-y-0 lg:flex-row lg:items-center lg:space-x-4"},Le={class:"grid grid-cols-2 gap-2"},je={class:"min-w-40 lg:min-w-0 lg:w-32 xl:w-40"},Te={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5"},Ne={key:2,class:"flex justify-center mt-5"},Qe={__name:"Batches",setup(a){var U;const n=j("$user"),C=j("$dayjs"),{brand:V}=ae(),D=h(0),E=h(20),b=h([]),y=h(null),p=h(""),k=h(!1),l=h({}),S=Y(()=>{var t;return(t=n.data)==null?void 0:t.is_student}),g=h(S.value?"All":"Upcoming"),$=h("start_date"),A=window.read_only_mode;le(()=>{O(),w(),b.value=[{label:"",value:null}]});const O=()=>{let t=new URLSearchParams(location.search);p.value=t.get("title")||"",y.value=t.get("category")||null,k.value=t.get("certification")||!1},_=se({doctype:"LMS Batch",url:"lms.lms.utils.get_batches",cache:["batches",(U=n.data)==null?void 0:U.name],pageLength:E.value,start:D.value,onSuccess(t){let e=t.map(r=>r.category);e=e.filter((r,m)=>e.indexOf(r)===m&&r),b.value.length<=e.length&&H(t)}}),w=()=>{q(),_.update({filters:l.value,orderBy:$.value}),_.reload()},q=()=>{z(),R(),Q(),G(),I(),K()},z=()=>{y.value?l.value.category=y.value:delete l.value.category},R=()=>{p.value?l.value.title=["like",`%${p.value}%`]:delete l.value.title},Q=()=>{k.value?l.value.certification=1:delete l.value.certification},G=()=>{$.value="start_date",n.data&&(g.value=="Enrolled"&&S.value?(l.value.enrolled=1,delete l.value.start_date,delete l.value.published,$.value="start_date desc"):S.value?delete l.value.enrolled:(delete l.value.start_date,delete l.value.published,$.value="start_date desc",g.value=="Upcoming"?(l.value.start_date=[">=",C().format("YYYY-MM-DD")],l.value.published=1,$.value="start_date"):g.value=="Archived"?l.value.start_date=["<=",C().format("YYYY-MM-DD")]:g.value=="Unpublished"&&(l.value.published=0)))},I=()=>{(!n.data||S.value&&g.value!="Enrolled")&&(l.value.start_date=[">=",C().format("YYYY-MM-DD")],l.value.published=1)},K=()=>{let t=new URLSearchParams(location.search),e={title:p.value,category:y.value,certification:k.value};Object.keys(e).forEach(m=>{e[m]?t.set(m,e[m]):t.delete(m)});let r="";t.toString()&&(r=`?${t.toString()}`),history.replaceState({},"",`${location.pathname}${r}`)},H=t=>{t.forEach(e=>{e.category&&!b.value.find(r=>r.value===e.category)&&b.value.push({label:e.category,value:e.category})})};oe(g,()=>{w()});const J=Y(()=>{var e,r,m;let t=[{label:__("All")}];return(e=n.data)!=null&&e.is_moderator||(r=n.data)!=null&&r.is_instructor||(m=n.data)!=null&&m.is_evaluator?(t.push({label:__("Upcoming")}),t.push({label:__("Archived")}),t.push({label:__("Unpublished")})):n.data&&t.push({label:__("Enrolled")}),t}),W=()=>{var t,e;return A?!1:!!((t=n.data)!=null&&t.is_moderator||(e=n.data)!=null&&e.is_instructor)},X=Y(()=>[{label:__("Batches"),route:{name:"Batches"}}]);return ne(()=>({title:__("Batches"),icon:V.favicon})),(t,e)=>{var m;const r=re("router-link");return o(),d(M,null,[u("header",De,[f(s(ce),{items:X.value},null,8,["items"]),W()?(o(),x(r,{key:0,to:{name:"BatchForm",params:{batchName:"new"}}},{default:B(()=>[f(s(T),{variant:"solid"},{prefix:B(()=>[f(s(ie),{class:"h-4 w-4 stroke-1.5"})]),default:B(()=>[F(" "+c(t.__("New")),1)]),_:1})]),_:1})):v("",!0)]),u("div",Ye,[u("div",Fe,[u("div",Me,c(t.__("All Batches")),1),u("div",Ue,[s(n).data?(o(),x(s(de),{key:0,buttons:J.value,modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=i=>g.value=i)},null,8,["buttons","modelValue"])):v("",!0),f(s(N),{modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=i=>k.value=i),label:t.__("Certification"),type:"checkbox",onChange:e[2]||(e[2]=i=>w())},null,8,["modelValue","label"]),u("div",Le,[f(s(N),{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=i=>p.value=i),placeholder:t.__("Search by Title"),type:"text",class:"min-w-40 lg:min-w-0 lg:w-32 xl:w-40",onInput:e[4]||(e[4]=i=>w())},null,8,["modelValue","placeholder"]),u("div",je,[b.value.length?(o(),x(s(ue),{key:0,modelValue:y.value,"onUpdate:modelValue":e[5]||(e[5]=i=>y.value=i),options:b.value,placeholder:t.__("Category"),onChange:e[6]||(e[6]=i=>w())},null,8,["modelValue","options","placeholder"])):v("",!0)])])])]),(m=s(_).data)!=null&&m.length?(o(),d("div",Te,[(o(!0),d(M,null,P(s(_).data,i=>(o(),x(r,{to:{name:"BatchDetail",params:{batchName:i.name}}},{default:B(()=>[f(Se,{batch:i},null,8,["batch"])]),_:2},1032,["to"]))),256))])):s(_).list.loading?v("",!0):(o(),x(he,{key:1,type:"Batches"})),!s(_).list.loading&&s(_).hasNextPage?(o(),d("div",Ne,[f(s(T),{onClick:e[7]||(e[7]=i=>s(_).next())},{default:B(()=>[F(c(t.__("Load More")),1)]),_:1})])):v("",!0)])],64)}}};export{Qe as default};
//# sourceMappingURL=Batches-5AoO7Cgk.js.map
