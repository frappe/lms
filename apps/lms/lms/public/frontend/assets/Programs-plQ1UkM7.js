import{s as E,i as R,r as V,z as T,eh as U,o as A,A as H,b as K,u as O,d as X,e as n,f as t,g,j as d,h as u,k as c,l as r,n as i,p as b,t as m,P as G,_ as $,F as v,x as M,B as j,bg as I,X as J,q as Q,M as W,a as z,H as Y}from"./index-D24HXhLT.js";import{_ as Z}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DRN2bHzK.js";import{_ as ee}from"./CourseCard-9Y8ICiAe.js";import{_ as se}from"./EmptyState.vue_vue_type_script_setup_true_lang-_-SuznPy.js";import"./UserAvatar-CNqvj4u9.js";import"./CourseInstructors-AYbj4319.js";import"./ProgressBar-rBBAZ6HI.js";const te={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},ae={key:0,class:"pt-5 px-5"},re={class:"mb-10"},oe={class:"flex items-center justify-between"},ne={class:"text-xl text-ink-gray-9 font-semibold"},le={class:"flex items-center space-x-2"},ie={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 mt-5"},me={class:"relative group"},ue={key:0,class:"absolute inset-0 bg-black-overlay-500 opacity-60 rounded-md"},ce={key:1,class:"absolute inset-0 flex items-center justify-center"},de={key:1,class:"text-sm italic text-ink-gray-5 mt-4"},Ne={__name:"Programs",setup(_e){const{brand:B}=E(),l=R("$user"),h=V(!1),p=T(),k=V(""),L=U(),y=window.read_only_mode;A(()=>{var e,s;!L.learningPaths.data&&!((e=l.data)!=null&&e.is_moderator)&&!((s=l.data)!=null&&s.is_instructor)&&p.push({name:"Courses"})});const N=H({url:"lms.lms.utils.get_programs",auto:!0,cache:"programs"}),S=e=>{z("frappe.client.insert",{doc:{doctype:"LMS Program",title:k.value}}).then(s=>{p.push({name:"ProgramForm",params:{programName:s.name}})})},F=(e,s)=>{z("lms.lms.utils.enroll_in_program_course",{program:e,course:s}).then(o=>{o.current_lesson?p.push({name:"Lesson",params:{courseName:s,chapterNumber:o.current_lesson.split("-")[0],lessonNumber:o.current_lesson.split("-")[1]}}):o&&p.push({name:"Lesson",params:{courseName:s,chapterNumber:1,lessonNumber:1}})}).catch(o=>{var _;Y.error(((_=o.messages)==null?void 0:_[0])||o)})},P=e=>{var s,o;return!((s=l.data)!=null&&s.is_moderator||(o=l.data)!=null&&o.is_instructor||e.membership||e.eligible)},q=()=>{var e,s;return y?!1:!!((e=l.data)!=null&&e.is_moderator||(s=l.data)!=null&&s.is_instructor)},D=K(()=>[{label:__("Programs")}]);return O(()=>({title:__("Programs"),icon:B.favicon})),(e,s)=>{var _;const o=X("router-link");return t(),n(v,null,[g("header",te,[u(r(Z),{items:D.value},null,8,["items"]),q()?(t(),d(r($),{key:0,onClick:s[0]||(s[0]=a=>h.value=!0),variant:"solid"},{prefix:i(()=>[u(r(G),{class:"h-4 w-4 stroke-1.5"})]),default:i(()=>[b(" "+m(e.__("New")),1)]),_:1})):c("",!0)]),(_=r(N).data)!=null&&_.length?(t(),n("div",ae,[(t(!0),n(v,null,M(r(N).data,a=>{var w,x,C;return t(),n("div",re,[g("div",oe,[g("div",ne,m(a.name),1),g("div",le,[a.members?(t(),d(r(j),{key:0,variant:"subtle",theme:"green",size:"lg"},{default:i(()=>[b(m(a.members)+" "+m(a.members==1?e.__("member"):e.__("members")),1)]),_:2},1024)):c("",!0),a.progress?(t(),d(r(j),{key:1,variant:"subtle",theme:"blue",size:"lg"},{default:i(()=>[b(m(a.progress)+m(e.__("% completed")),1)]),_:2},1024)):c("",!0),(w=r(l).data)!=null&&w.is_moderator||(x=r(l).data)!=null&&x.is_instructor?(t(),d(o,{key:2,to:{name:"ProgramForm",params:{programName:a.name}}},{default:i(()=>[r(y)?c("",!0):(t(),d(r($),{key:0},{prefix:i(()=>[u(r(I),{class:"h-4 w-4 stroke-1.5"})]),default:i(()=>[b(" "+m(e.__("Edit")),1)]),_:1}))]),_:2},1032,["to"])):c("",!0)])]),(C=a.courses)!=null&&C.length?(t(),n("div",ie,[(t(!0),n(v,null,M(a.courses,f=>(t(),n("div",me,[u(ee,{course:f,onClick:pe=>F(a.name,f.name),class:"cursor-pointer"},null,8,["course","onClick"]),P(f)?(t(),n("div",ue)):c("",!0),P(f)?(t(),n("div",ce,[u(r(J),{class:"size-10 text-ink-white"})])):c("",!0)]))),256))])):(t(),n("div",de,m(e.__("No courses in this program")),1))])}),256))])):(t(),d(se,{key:1,type:"Programs"})),u(r(W),{modelValue:h.value,"onUpdate:modelValue":s[2]||(s[2]=a=>h.value=a),options:{title:e.__("New Program"),actions:[{label:e.__("Create"),variant:"solid",onClick:()=>S(e.close)}]}},{"body-content":i(()=>[u(r(Q),{label:e.__("Title"),modelValue:k.value,"onUpdate:modelValue":s[1]||(s[1]=a=>k.value=a)},null,8,["label","modelValue"])]),_:1},8,["modelValue","options"])],64)}}};export{Ne as default};
//# sourceMappingURL=Programs-plQ1UkM7.js.map
