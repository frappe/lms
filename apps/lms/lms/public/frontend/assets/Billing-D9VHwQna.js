import{e as _,f as b,g as l,p as k,t as i,h as d,n as C,l as n,_ as $,i as T,s as z,o as D,A as v,L as E,b as G,H as w,u as I,k as y,q as c,j as P,ag as L}from"./index-D24HXhLT.js";import{_ as q}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DRN2bHzK.js";const H={class:"text-base border rounded-md w-1/3 mx-auto my-32"},K={class:"border-b px-5 py-3 font-medium"},O={class:"px-5 py-3"},R={class:"mb-4 leading-6"},S={__name:"NotPermitted",props:{title:{type:String,default:"Not Permitted"},text:{type:String,default:"You are not permitted to access this page."},buttonLabel:{type:String,default:"Login"},buttonLink:{type:String,default:"/login"}},setup(u){const g=u,h=()=>{window.location.href=g.buttonLink};return(a,m)=>(b(),_("div",H,[l("div",K,[m[1]||(m[1]=l("span",{class:"inline-flex items-center before:bg-surface-red-5 before:w-2 before:h-2 before:rounded-md before:mr-2"},null,-1)),k(" "+i(a.__(u.title)),1)]),l("div",O,[l("div",R,i(a.__(u.text)),1),d(n($),{variant:"solid",class:"w-full",onClick:m[0]||(m[0]=r=>h())},{default:C(()=>[k(i(a.__(u.buttonLabel)),1)]),_:1})])]))}},W={class:""},F={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},J={key:0,class:"pt-5 pb-10 mx-5"},Y={class:"flex flex-col lg:flex-row justify-between"},Q={class:"h-fit bg-surface-gray-2 rounded-md p-5 space-y-4 lg:order-last mb-10 lg:mt-10 font-medium lg:w-1/3"},X={class:"flex items-baseline justify-between space-y-2"},Z={class:"text-ink-gray-5"},ee={class:"leading-5"},te={key:0,class:"flex items-center justify-between"},se={class:"text-ink-gray-5"},le={class:""},ne={key:1,class:"flex items-center justify-between mt-2"},oe={class:"text-ink-gray-5"},ae={class:"flex items-center justify-between border-t border-outline-gray-3 pt-4 mt-2"},ie={class:"text-lg font-semibold"},re={class:"text-lg font-semibold"},de={class:"flex-1 lg:mr-10"},ue={class:"mb-5"},me={class:"text-lg font-semibold"},ce={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},be={class:"space-y-4"},_e={class:"space-y-4"},pe={class:"flex items-center justify-between border-t pt-4 mt-8"},ye={class:"text-ink-gray-5"},ge={key:1},fe={key:2},ke={__name:"Billing",props:{type:{type:String,required:!0},name:{type:String,required:!0}},setup(u){const g=T("$user"),{brand:h}=z();D(()=>{var s;const e=document.createElement("script");e.src="https://checkout.razorpay.com/v1/checkout.js",document.body.appendChild(e),(s=g.data)!=null&&s.name&&m.submit()});const a=u,m=v({url:"lms.lms.api.validate_billing_access",params:{billing_type:a.type,name:a.name},onSuccess(e){B(e.address),r.submit()}}),r=v({url:"lms.lms.utils.get_order_summary",makeParams(e){return{doctype:a.type=="batch"?"LMS Batch":"LMS Course",docname:a.name,country:t.country}},onError(e){N(e)}}),t=E({}),B=e=>{t.billing_name=(e==null?void 0:e.billing_name)||"",t.address_line1=(e==null?void 0:e.address_line1)||"",t.address_line2=(e==null?void 0:e.address_line2)||"",t.city=(e==null?void 0:e.city)||"",t.state=(e==null?void 0:e.state)||"",t.country=(e==null?void 0:e.country)||"",t.pincode=(e==null?void 0:e.pincode)||"",t.phone=(e==null?void 0:e.phone)||"",t.source=(e==null?void 0:e.source)||"",t.gstin=(e==null?void 0:e.gstin)||"",t.pan=(e==null?void 0:e.pan)||""},j=v({url:"lms.lms.payments.get_payment_link",makeParams(e){return{doctype:a.type=="batch"?"LMS Batch":"LMS Course",docname:a.name,title:r.data.title,amount:r.data.original_amount,total_amount:r.data.amount,currency:r.data.currency,address:t,redirect_to:A.value,payment_for_certificate:a.type=="certificate"}}}),x=()=>{j.submit({},{validate(){return t.source?M():__("Please let us know where you heard about us from.")},onSuccess(e){window.location.href=e},onError(e){var s;w.error(((s=e.messages)==null?void 0:s[0])||e)}})},M=()=>{let e=["billing_name","address_line1","city","pincode","country","phone","source"];for(let p of e)if(!t[p])return"Please enter a valid "+p.replaceAll("_"," ").toLowerCase().replace(/\b\w/g,f=>f.toUpperCase());if(t.gstin&&!t.pan)return"Please enter a valid pan number.";if(t.country=="India"&&!t.state)return"Please enter a valid state with correct spelling and the first letter capitalized.";const s=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Delhi","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal"];if(t.country=="India"&&!s.includes(t.state))return"Please enter a valid state with correct spelling and the first letter capitalized.";console.log("validation address")},N=e=>{var s;w.error(((s=e.messages)==null?void 0:s[0])||e)},U=e=>{t.country=e,r.reload()},A=G(()=>{if(a.type=="course")return`/lms/courses/${a.name}`;if(a.type=="batch")return`/lms/batches/${a.name}`;if(a.type=="certificate")return`/lms/courses/${a.name}/certification`});return I(()=>({title:__("Billing Details"),icon:h.favicon})),(e,s)=>{var p,f,V;return b(),_("div",W,[l("header",F,[d(n(q),{class:"h-7",items:[{label:e.__("Billing Details"),route:{name:"Billing"}}]},null,8,["items"])]),(p=n(m).data)!=null&&p.access&&n(r).data?(b(),_("div",J,[l("div",Y,[l("div",Q,[l("div",X,[l("div",Z,i(e.__("Payment for "))+" "+i(u.type)+": ",1),l("div",ee,i(n(r).data.title),1)]),n(r).data.gst_applied?(b(),_("div",te,[l("div",se,i(e.__("Original Amount")),1),l("div",le,i(n(r).data.original_amount_formatted),1)])):y("",!0),n(r).data.gst_applied?(b(),_("div",ne,[l("div",oe,i(e.__("GST Amount")),1),l("div",null,i(n(r).data.gst_amount_formatted),1)])):y("",!0),l("div",ae,[l("div",ie,i(e.__("Total")),1),l("div",re,i(n(r).data.total_amount_formatted),1)])]),l("div",de,[l("div",ue,[l("div",me,i(e.__("Address")),1)]),l("div",ce,[l("div",be,[d(n(c),{label:e.__("Billing Name"),modelValue:t.billing_name,"onUpdate:modelValue":s[0]||(s[0]=o=>t.billing_name=o)},null,8,["label","modelValue"]),d(n(c),{label:e.__("Address Line 1"),modelValue:t.address_line1,"onUpdate:modelValue":s[1]||(s[1]=o=>t.address_line1=o)},null,8,["label","modelValue"]),d(n(c),{label:e.__("Address Line 2"),modelValue:t.address_line2,"onUpdate:modelValue":s[2]||(s[2]=o=>t.address_line2=o)},null,8,["label","modelValue"]),d(n(c),{label:e.__("City"),modelValue:t.city,"onUpdate:modelValue":s[3]||(s[3]=o=>t.city=o)},null,8,["label","modelValue"]),d(n(c),{label:e.__("State"),modelValue:t.state,"onUpdate:modelValue":s[4]||(s[4]=o=>t.state=o)},null,8,["label","modelValue"])]),l("div",_e,[d(L,{doctype:"Country",value:t.country,onChange:s[5]||(s[5]=o=>U(o)),label:e.__("Country")},null,8,["value","label"]),d(n(c),{label:e.__("Postal Code"),modelValue:t.pincode,"onUpdate:modelValue":s[6]||(s[6]=o=>t.pincode=o)},null,8,["label","modelValue"]),d(n(c),{label:e.__("Phone Number"),modelValue:t.phone,"onUpdate:modelValue":s[7]||(s[7]=o=>t.phone=o)},null,8,["label","modelValue"]),d(L,{doctype:"LMS Source",value:t.source,onChange:s[8]||(s[8]=o=>t.source=o),label:e.__("Where did you hear about us?")},null,8,["value","label"]),t.country=="India"?(b(),P(n(c),{key:0,label:e.__("GST Number"),modelValue:t.gstin,"onUpdate:modelValue":s[9]||(s[9]=o=>t.gstin=o)},null,8,["label","modelValue"])):y("",!0),t.country=="India"?(b(),P(n(c),{key:1,label:e.__("Pan Number"),modelValue:t.pan,"onUpdate:modelValue":s[10]||(s[10]=o=>t.pan=o)},null,8,["label","modelValue"])):y("",!0)])]),l("div",pe,[l("p",ye,i(e.__("Make sure to enter the correct billing name as the same will be used in your invoice.")),1),d(n($),{variant:"solid",size:"md",onClick:s[11]||(s[11]=o=>x())},{default:C(()=>[k(i(e.__("Proceed to Payment")),1)]),_:1})])])])])):(f=n(m).data)!=null&&f.message?(b(),_("div",ge,[d(S,{text:n(m).data.message,buttonLabel:u.type=="course"?"Checkout Course":"Checkout Batch",buttonLink:u.type=="course"?`/lms/courses/${u.name}`:`/lms/batches/${u.name}`},null,8,["text","buttonLabel","buttonLink"])])):(V=n(g).data)!=null&&V.name?y("",!0):(b(),_("div",fe,[d(S,{text:"Please login to access this page.",buttonLink:`/login?redirect-to=/lms/billing/${u.type}/${u.name}`},null,8,["buttonLink"])]))])}}};export{ke as default};
//# sourceMappingURL=Billing-D9VHwQna.js.map
