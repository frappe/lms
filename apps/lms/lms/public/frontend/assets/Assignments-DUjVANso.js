import{aq as B,J as E,K as M,L as z,w as F,b as h,d as O,j as A,f as g,n as v,g as c,t as y,h as r,l as s,q as $,p as C,aG as G,k as x,_ as q,M as H,H as S,i as T,r as V,s as J,z as K,o as Q,c as W,a as X,u as Y,e as D,P as Z,ap as ee,N as se,F as te}from"./index-D24HXhLT.js";import{_ as ne}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DRN2bHzK.js";import{_ as ae}from"./EmptyState.vue_vue_type_script_setup_true_lang-_-SuznPy.js";const le={class:"p-5 text-base"},oe={class:"text-lg text-ink-gray-9 font-semibold mb-5"},ie={class:"space-y-4 max-h-[75vh] overflow-y-auto"},ue={class:"text-xs text-ink-gray-5 mb-2"},re={class:"flex justify-end space-x-2 mt-5"},me=B({__name:"AssignmentForm",props:E({assignmentID:{type:String,default:"new"}},{modelValue:{},modelModifiers:{},assignments:{},assignmentsModifiers:{}}),emits:["update:modelValue","update:assignments"],setup(f){const p=M(f,"modelValue"),b=M(f,"assignments"),t=z({title:"",type:"",question:""}),o=f;F(()=>o.assignmentID,l=>{var a;l!=="new"&&((a=b.value)==null||a.data.forEach(i=>{i.name===l&&(t.title=i.title,t.type=i.type,t.question=i.question)}))},{flush:"post"});const _=()=>{o.assignmentID=="new"?b.value.insert.submit({...t},{onSuccess(){p.value=!1,S.success(__("Assignment created successfully"))}}):b.value.setValue.submit({...t,name:o.assignmentID},{onSuccess(){p.value=!1,S.success(__("Assignment updated successfully"))}})},w=h(()=>[{label:"PDF",value:"PDF"},{label:"Image",value:"Image"},{label:"Document",value:"Document"},{label:"Text",value:"Text"},{label:"URL",value:"URL"}]);return(l,a)=>{const i=O("router-link");return g(),A(s(H),{modelValue:p.value,"onUpdate:modelValue":a[3]||(a[3]=m=>p.value=m),options:{size:"lg"}},{body:v(()=>[c("div",le,[c("div",oe,y(f.assignmentID==="new"?l.__("Create an Assignment"):l.__("Edit Assignment")),1),c("div",ie,[r(s($),{modelValue:t.title,"onUpdate:modelValue":a[0]||(a[0]=m=>t.title=m),label:l.__("Title"),required:!0},null,8,["modelValue","label"]),r(s($),{modelValue:t.type,"onUpdate:modelValue":a[1]||(a[1]=m=>t.type=m),type:"select",options:w.value,label:l.__("Submission Type"),required:!0},null,8,["modelValue","options","label"]),c("div",null,[c("div",ue,[C(y(l.__("Question"))+" ",1),a[4]||(a[4]=c("span",{class:"text-ink-red-3"},"*",-1))]),r(s(G),{content:t.question,onChange:a[2]||(a[2]=m=>t.question=m),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem] max-h-[18rem] overflow-y-auto"},null,8,["content"])])]),c("div",re,[r(i,{to:{name:"AssignmentSubmissionList",query:{assignmentID:f.assignmentID}}},{default:v(()=>[f.assignmentID!=="new"?(g(),A(s(q),{key:0,variant:"subtle"},{default:v(()=>[C(y(l.__("Check Submissions")),1)]),_:1})):x("",!0)]),_:1},8,["to"]),r(s(q),{variant:"solid",onClick:_},{default:v(()=>[C(y(l.__("Save")),1)]),_:1})])])]),_:1},8,["modelValue"])}}}),de={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},ce={class:"md:w-3/4 md:mx-auto py-5 mx-5"},pe={class:"flex items-center justify-between mb-5"},ge={key:0,class:"text-xl font-semibold text-ink-gray-7 mb-4"},fe={key:1,class:"grid grid-cols-2 gap-5"},ve={key:2,class:"flex justify-center my-5"},we={__name:"Assignments",setup(f){const p=T("$user"),b=T("$dayjs"),t=V(""),o=V(""),_=V(!1),w=V("new"),l=V(0),{brand:a}=J(),i=K(),m=window.read_only_mode;Q(()=>{var n,e;!((n=p.data)!=null&&n.is_moderator)&&!((e=p.data)!=null&&e.is_instructor)&&i.push({name:"Courses"}),j(),t.value=i.currentRoute.value.query.title,o.value=i.currentRoute.value.query.type}),F([t,o],()=>{i.push({query:{title:t.value,type:o.value}}),U()});const U=()=>{u.update({filters:L.value}),u.reload()},L=h(()=>{var e,k;let n={};return t.value&&(n.title=["like",`%${t.value}%`]),o.value&&(n.type=o.value),(e=p.data)!=null&&e.is_moderator||(n.owner=(k=p.data)==null?void 0:k.email),n}),u=W({doctype:"LMS Assignment",fields:["name","title","type","creation","question"],orderBy:"modified desc",cache:["assignments"],transform(n){return n.map(e=>({...e,creation:b(e.creation).fromNow()}))}}),R=h(()=>[{label:__("Title"),key:"title",width:2},{label:__("Type"),key:"type",width:1,align:"left"},{label:__("Created"),key:"creation",width:1,align:"right"}]),j=()=>{X("frappe.client.get_count",{doctype:"LMS Assignment"}).then(n=>{l.value=n})},N=h(()=>["","Document","Image","PDF","URL","Text"].map(e=>({label:__(e),value:e}))),P=h(()=>[{label:"Assignments",route:{name:"Assignments"}}]);return Y(()=>({title:__("Assignments"),icon:a.favicon})),(n,e)=>{var k,I;return g(),D(te,null,[c("header",de,[r(s(ne),{items:P.value},null,8,["items"]),s(m)?x("",!0):(g(),A(s(q),{key:0,variant:"solid",onClick:e[0]||(e[0]=()=>{w.value="new",_.value=!0})},{prefix:v(()=>[r(s(Z),{class:"w-4 h-4"})]),default:v(()=>[C(" "+y(n.__("New")),1)]),_:1}))]),c("div",ce,[c("div",pe,[l.value?(g(),D("div",ge,y(n.__("{0} Assignments").format(l.value)),1)):x("",!0),(k=s(u).data)!=null&&k.length||n.assigmentCount>0?(g(),D("div",fe,[r(s($),{modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=d=>t.value=d),placeholder:n.__("Search by title")},null,8,["modelValue","placeholder"]),r(s($),{modelValue:o.value,"onUpdate:modelValue":e[2]||(e[2]=d=>o.value=d),type:"select",options:N.value,placeholder:n.__("Type")},null,8,["modelValue","options","placeholder"])])):x("",!0)]),(I=s(u).data)!=null&&I.length?(g(),A(s(ee),{key:0,columns:R.value,rows:s(u).data,"row-key":"name",options:{showTooltip:!1,selectable:!1,onRowClick:d=>{s(m)||(w.value=d.name,_.value=!0)}}},null,8,["columns","rows","options"])):(g(),A(ae,{key:1,type:"Assignments"})),s(u).data&&s(u).hasNextPage?(g(),D("div",ve,[r(s(q),{onClick:e[3]||(e[3]=d=>s(u).next())},{default:v(()=>[C(y(n.__("Load More")),1)]),_:1})])):x("",!0)]),r(me,{modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=d=>_.value=d),assignments:s(u),"onUpdate:assignments":e[5]||(e[5]=d=>se(u)?u.value=d:null),assignmentID:w.value},null,8,["modelValue","assignments","assignmentID"])],64)}}};export{we as default};
//# sourceMappingURL=Assignments-DUjVANso.js.map
