{"version":3,"file":"LessonForm-D-BB9MFd.js","sources":["../../../../frontend/src/components/Modals/ExplanationVideos.vue","../../../../frontend/src/components/LessonHelp.vue","../../../../frontend/src/pages/LessonForm.vue"],"sourcesContent":["<template>\n\t<Dialog\n\t\tv-model=\"show\"\n\t\t:options=\"{\n\t\t\tsize: '4xl',\n\t\t\ttitle: title,\n\t\t}\"\n\t>\n\t\t<template #body-content>\n\t\t\t<div>\n\t\t\t\t<VideoBlock :file=\"file\" />\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n<script setup>\nimport { Dialog } from 'frappe-ui'\nimport { computed } from 'vue'\nimport VideoBlock from '@/components/VideoBlock.vue'\n\nconst show = defineModel()\n\nconst props = defineProps({\n\ttype: {\n\t\ttype: [String, null],\n\t\trequired: true,\n\t},\n\ttitle: {\n\t\ttype: [String, null],\n\t\trequired: true,\n\t},\n})\n\nconst file = computed(() => {\n\tif (props.type == 'youtube') return '/assets/lms/frontend/Youtube.mp4'\n\tif (props.type == 'quiz') return '/assets/lms/frontend/Quiz.mp4'\n\tif (props.type == 'upload') return '/assets/lms/frontend/Upload.mp4'\n})\n</script>\n","<template>\n\t<div class=\"space-y-5 text-ink-gray-9\">\n\t\t<div class=\"space-y-2\">\n\t\t\t<div class=\"flex items-center text-sm font-medium space-x-2\">\n\t\t\t\t<span>\n\t\t\t\t\t{{ __('What does include in preview mean?') }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t<div class=\"text-xs text-ink-gray-5 mb-1 leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t__(\n\t\t\t\t\t\t'If Include in Preview is enabled for a lesson then the lesson will also be accessible to non logged in users.'\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"space-y-2\">\n\t\t\t<div\n\t\t\t\tclass=\"flex items-center text-sm font-medium space-x-2 cursor-pointer\"\n\t\t\t\t@click=\"openHelpDialog('quiz')\"\n\t\t\t>\n\t\t\t\t<span>\n\t\t\t\t\t{{ __('How to add a Quiz?') }}\n\t\t\t\t</span>\n\t\t\t\t<Info class=\"w-3 h-3 text-ink-gray-7\" />\n\t\t\t</div>\n\t\t\t<div class=\"text-xs text-ink-gray-5 mb-1 leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t__(\n\t\t\t\t\t\t'Click on the add icon in the editor and select Quiz from the menu. It opens up a dialog, where you can either select a quiz from the list or create a new quiz. When you select the Create New option it redirects you to the quiz creation page.'\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"space-y-2\">\n\t\t\t<div\n\t\t\t\tclass=\"flex text-sm font-medium space-x-2 cursor-pointer\"\n\t\t\t\t@click=\"openHelpDialog('upload')\"\n\t\t\t>\n\t\t\t\t<span class=\"leading-5\">\n\t\t\t\t\t{{ __(contentMap['upload']) }}\n\t\t\t\t</span>\n\t\t\t\t<Info class=\"w-3 h-3 text-ink-gray-7\" />\n\t\t\t</div>\n\t\t\t<div class=\"text-xs text-ink-gray-5 mb-1 leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t__(\n\t\t\t\t\t\t'To upload Image, Video, Audio or PDF from your system, click on the add icon and select upload from the menu. Then choose the file you want to add to the lesson and it gets added to your lesson.'\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"space-y-2\">\n\t\t\t<div\n\t\t\t\tclass=\"flex items-center text-sm font-medium space-x-2 cursor-pointer\"\n\t\t\t\t@click=\"openHelpDialog('youtube')\"\n\t\t\t>\n\t\t\t\t<span>\n\t\t\t\t\t{{ __(contentMap['youtube']) }}\n\t\t\t\t</span>\n\t\t\t\t<Info class=\"w-3 h-3 text-ink-gray-7\" />\n\t\t\t</div>\n\t\t\t<div class=\"text-xs text-ink-gray-5 mb-1 leading-5\">\n\t\t\t\t{{\n\t\t\t\t\t__(\n\t\t\t\t\t\t'Copy the URL of the video from YouTube and paste it in the editor.'\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<ExplanationVideos v-model=\"showExplanation\" :title=\"title\" :type=\"type\" />\n</template>\n<script setup>\nimport { Info } from 'lucide-vue-next'\nimport { ref } from 'vue'\nimport ExplanationVideos from '@/components/Modals/ExplanationVideos.vue'\n\nconst showExplanation = ref(false)\nconst type = ref(null)\nconst title = ref(null)\nconst contentMap = {\n\tquiz: 'How to add a Quiz?',\n\tupload: 'How to upload content from your system?',\n\tyoutube: 'How to add a YouTube Video?',\n}\n\nconst openHelpDialog = (contentType) => {\n\ttype.value = contentType\n\ttitle.value = contentMap[contentType]\n\tshowExplanation.value = true\n}\n</script>\n","<template>\n\t<div class=\"\">\n\t\t<div class=\"grid md:grid-cols-[75%,25%] h-screen\">\n\t\t\t<div class=\"border-r\">\n\t\t\t\t<header\n\t\t\t\t\tclass=\"sticky top-0 z-10 flex flex-col md:flex-row md:items-center justify-between border-b overflow-hidden bg-surface-white px-3 py-2.5 sm:px-5\"\n\t\t\t\t>\n\t\t\t\t\t<Breadcrumbs class=\"text-ellipsis\" :items=\"breadcrumbs\" />\n\t\t\t\t\t<Button\n\t\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t\t@click=\"saveLesson({ showSuccessMessage: true })\"\n\t\t\t\t\t\tclass=\"mt-3 md:mt-0\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ __('Save') }}\n\t\t\t\t\t</Button>\n\t\t\t\t</header>\n\t\t\t\t<div class=\"py-5\">\n\t\t\t\t\t<div class=\"w-5/6 mx-auto\">\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"lesson.title\"\n\t\t\t\t\t\t\tlabel=\"Title\"\n\t\t\t\t\t\t\tclass=\"mb-4\"\n\t\t\t\t\t\t\t:required=\"true\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"lesson.include_in_preview\"\n\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\tlabel=\"Include in Preview\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"border-t mt-4\">\n\t\t\t\t\t\t<div class=\"w-5/6 mx-auto pt-4\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"flex justify-between cursor-pointer\"\n\t\t\t\t\t\t\t\t@click=\"\n\t\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\t\topenInstructorEditor = !openInstructorEditor\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<label class=\"block font-medium text-ink-gray-5 mb-1\">\n\t\t\t\t\t\t\t\t\t{{ __('Instructor Notes') }}\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<ChevronRight\n\t\t\t\t\t\t\t\t\tclass=\"stroke-2 h-5 w-5 text-ink-gray-5\"\n\t\t\t\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t\t\t\t'rotate-90 transform duration-200': openInstructorEditor,\n\t\t\t\t\t\t\t\t\t\t'duration-200': !openInstructorEditor,\n\t\t\t\t\t\t\t\t\t}\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-show=\"openInstructorEditor\"\n\t\t\t\t\t\t\t\tid=\"instructor-notes\"\n\t\t\t\t\t\t\t\tclass=\"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal py-3\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"border-t mt-4\">\n\t\t\t\t\t\t<div class=\"w-5/6 mx-auto pt-4\">\n\t\t\t\t\t\t\t<label class=\"block font-medium text-ink-gray-5 mb-1\">\n\t\t\t\t\t\t\t\t{{ __('Content') }}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tid=\"content\"\n\t\t\t\t\t\t\t\tclass=\"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal py-3\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"\">\n\t\t\t\t<div class=\"sticky top-0 p-5\">\n\t\t\t\t\t<LessonHelp />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tBreadcrumbs,\n\tButton,\n\tcreateResource,\n\tFormControl,\n\tusePageMeta,\n\ttoast,\n} from 'frappe-ui'\nimport {\n\tcomputed,\n\treactive,\n\tonMounted,\n\tinject,\n\tref,\n\tonBeforeUnmount,\n} from 'vue'\nimport { sessionStore } from '../stores/session'\nimport EditorJS from '@editorjs/editorjs'\nimport LessonHelp from '@/components/LessonHelp.vue'\nimport { ChevronRight } from 'lucide-vue-next'\nimport { getEditorTools, enablePlyr } from '@/utils'\nimport { capture } from '@/telemetry'\nimport { useOnboarding } from 'frappe-ui/frappe'\n\nconst { brand } = sessionStore()\nconst editor = ref(null)\nconst instructorEditor = ref(null)\nconst user = inject('$user')\nconst openInstructorEditor = ref(false)\nconst { updateOnboardingStep } = useOnboarding('learning')\nlet autoSaveInterval\nlet showSuccessMessage = false\n\nconst props = defineProps({\n\tcourseName: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tchapterNumber: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tlessonNumber: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nonMounted(() => {\n\tif (!user.data?.is_moderator && !user.data?.is_instructor) {\n\t\twindow.location.href = '/login'\n\t}\n\tcapture('lesson_form_opened')\n\teditor.value = renderEditor('content')\n\tinstructorEditor.value = renderEditor('instructor-notes')\n\twindow.addEventListener('keydown', keyboardShortcut)\n\tenablePlyr()\n})\n\nconst renderEditor = (holder) => {\n\treturn new EditorJS({\n\t\tholder: holder,\n\t\ttools: getEditorTools(true),\n\t\tautofocus: true,\n\t\tdefaultBlock: 'markdown',\n\t\tonChange: async (api, event) => {\n\t\t\tenablePlyr()\n\t\t},\n\t})\n}\n\nconst lesson = reactive({\n\ttitle: '',\n\tinclude_in_preview: false,\n\tbody: '',\n\tinstructor_notes: '',\n\tcontent: '',\n})\n\nconst lessonDetails = createResource({\n\turl: 'lms.lms.utils.get_lesson_creation_details',\n\tparams: {\n\t\tcourse: props.courseName,\n\t\tchapter: props.chapterNumber,\n\t\tlesson: props.lessonNumber,\n\t},\n\tauto: true,\n\tonSuccess(data) {\n\t\tif (data.lesson) {\n\t\t\tObject.keys(data.lesson).forEach((key) => {\n\t\t\t\tlesson[key] = data.lesson[key]\n\t\t\t})\n\t\t\tlesson.include_in_preview = data?.lesson?.include_in_preview\n\t\t\t\t? true\n\t\t\t\t: false\n\t\t\taddLessonContent(data)\n\t\t\taddInstructorNotes(data)\n\t\t\tenableAutoSave()\n\t\t}\n\t},\n})\n\nconst addLessonContent = (data) => {\n\teditor.value.isReady.then(() => {\n\t\tif (data.lesson.content) {\n\t\t\teditor.value.render(JSON.parse(data.lesson.content))\n\t\t} else if (data.lesson.body) {\n\t\t\tlet blocks = convertToJSON(data.lesson)\n\t\t\teditor.value.render({\n\t\t\t\tblocks: blocks,\n\t\t\t})\n\t\t}\n\t})\n}\n\nconst addInstructorNotes = (data) => {\n\tinstructorEditor.value.isReady.then(() => {\n\t\tif (data.lesson.instructor_content) {\n\t\t\tinstructorEditor.value.render(JSON.parse(data.lesson.instructor_content))\n\t\t} else if (data.lesson.instructor_notes) {\n\t\t\tlet blocks = convertToJSON(data.lesson)\n\t\t\tinstructorEditor.value.render({\n\t\t\t\tblocks: blocks,\n\t\t\t})\n\t\t}\n\t})\n}\n\nconst enableAutoSave = () => {\n\tautoSaveInterval = setInterval(() => {\n\t\tsaveLesson({ showSuccessMessage: false })\n\t}, 10000)\n}\n\nconst keyboardShortcut = (e) => {\n\tif (\n\t\te.key === 's' &&\n\t\t(e.ctrlKey || e.metaKey) &&\n\t\t!e.target.classList.contains('ProseMirror')\n\t) {\n\t\tsaveLesson({ showSuccessMessage: true })\n\t\te.preventDefault()\n\t}\n}\n\nonBeforeUnmount(() => {\n\tclearInterval(autoSaveInterval)\n\twindow.removeEventListener('keydown', keyboardShortcut)\n})\n\nconst newLessonResource = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Course Lesson',\n\t\t\t\tcourse: props.courseName,\n\t\t\t\tchapter: lessonDetails.data?.chapter.name,\n\t\t\t\t...lesson,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst editLesson = createResource({\n\turl: 'frappe.client.set_value',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Course Lesson',\n\t\t\tname: values.lesson,\n\t\t\tfieldname: lesson,\n\t\t}\n\t},\n})\n\nconst lessonReference = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Lesson Reference',\n\t\t\t\tparent: lessonDetails.data?.chapter.name,\n\t\t\t\tparenttype: 'Course Chapter',\n\t\t\t\tparentfield: 'lessons',\n\t\t\t\tlesson: values.lesson,\n\t\t\t\tidx: props.lessonNumber,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst convertToJSON = (lessonData) => {\n\tlet blocks = []\n\tif (lessonData.youtube) {\n\t\tlet youtubeID = lessonData.youtube.split('/').pop()\n\t\tblocks.push({\n\t\t\ttype: 'embed',\n\t\t\tdata: {\n\t\t\t\tservice: 'youtube',\n\t\t\t\tembed: `https://www.youtube.com/embed/${youtubeID}`,\n\t\t\t},\n\t\t})\n\t}\n\tlessonData.body.split('\\n').forEach((block) => {\n\t\tif (block.includes('{{ YouTubeVideo')) {\n\t\t\tlet youtubeID = block.match(/\\([\"']([^\"']+?)[\"']\\)/)[1]\n\t\t\tif (!youtubeID.includes('https://'))\n\t\t\t\tyoutubeID = `https://www.youtube.com/embed/${youtubeID}`\n\t\t\tblocks.push({\n\t\t\t\ttype: 'embed',\n\t\t\t\tdata: {\n\t\t\t\t\tservice: 'youtube',\n\t\t\t\t\tembed: youtubeID,\n\t\t\t\t},\n\t\t\t})\n\t\t} else if (block.includes('{{ Quiz')) {\n\t\t\tlet quiz = block.match(/\\([\"']([^\"']+?)[\"']\\)/)[1]\n\t\t\tblocks.push({\n\t\t\t\ttype: 'quiz',\n\t\t\t\tdata: {\n\t\t\t\t\tquiz: quiz,\n\t\t\t\t},\n\t\t\t})\n\t\t} else if (block.includes('{{ Video')) {\n\t\t\tlet video = block.match(/\\([\"']([^\"']+?)[\"']\\)/)[1]\n\t\t\tblocks.push({\n\t\t\t\ttype: 'upload',\n\t\t\t\tdata: {\n\t\t\t\t\tfile_url: video,\n\t\t\t\t\tfile_type: video.split('.').pop(),\n\t\t\t\t},\n\t\t\t})\n\t\t} else if (block.includes('{{ Audio')) {\n\t\t\tlet audio = block.match(/\\([\"']([^\"']+?)[\"']\\)/)[1]\n\t\t\tblocks.push({\n\t\t\t\ttype: 'upload',\n\t\t\t\tdata: {\n\t\t\t\t\tfile_url: audio,\n\t\t\t\t\tfile_type: audio.split('.').pop(),\n\t\t\t\t},\n\t\t\t})\n\t\t} else if (block.includes('{{ PDF')) {\n\t\t\tlet pdf = block.match(/\\([\"']([^\"']+?)[\"']\\)/)[1]\n\t\t\tblocks.push({\n\t\t\t\ttype: 'upload',\n\t\t\t\tdata: {\n\t\t\t\t\tfile_url: pdf,\n\t\t\t\t\tfile_type: 'pdf',\n\t\t\t\t},\n\t\t\t})\n\t\t} else if (block.includes('{{ Embed')) {\n\t\t\tlet embed = block.match(/\\([\"']([^\"']+?)[\"']\\)/)[1]\n\t\t\tblocks.push({\n\t\t\t\ttype: 'embed',\n\t\t\t\tdata: {\n\t\t\t\t\tservice: embed.split('|||')[0],\n\t\t\t\t\tembed: embed.split('|||')[1],\n\t\t\t\t},\n\t\t\t})\n\t\t} else if (block.includes('![]')) {\n\t\t\tlet image = block.match(/\\((.*?)\\)/)[1]\n\t\t\tblocks.push({\n\t\t\t\ttype: 'upload',\n\t\t\t\tdata: {\n\t\t\t\t\tfile_url: image,\n\t\t\t\t\tfile_type: 'image',\n\t\t\t\t},\n\t\t\t})\n\t\t} else if (block.includes('#')) {\n\t\t\tlet level = (block.match(/#/g) || []).length\n\t\t\tblocks.push({\n\t\t\t\ttype: 'header',\n\t\t\t\tdata: {\n\t\t\t\t\ttext: block.replace(/#/g, '').trim(),\n\t\t\t\t\tlevel: level,\n\t\t\t\t},\n\t\t\t})\n\t\t} else {\n\t\t\tblocks.push({\n\t\t\t\ttype: 'paragraph',\n\t\t\t\tdata: {\n\t\t\t\t\ttext: block,\n\t\t\t\t},\n\t\t\t})\n\t\t}\n\t})\n\n\tif (lessonData.quizId) {\n\t\tblocks.push({\n\t\t\ttype: 'quiz',\n\t\t\tdata: {\n\t\t\t\tquiz: lessonData.quizId,\n\t\t\t},\n\t\t})\n\t}\n\n\treturn blocks\n}\n\nconst saveLesson = (e) => {\n\tshowSuccessMessage = false\n\tif (typeof e != 'undefined' && e.showSuccessMessage) {\n\t\tshowSuccessMessage = true\n\t}\n\teditor.value.save().then((outputData) => {\n\t\tlesson.content = JSON.stringify(outputData)\n\t\tinstructorEditor.value.save().then((outputData) => {\n\t\t\tlesson.instructor_content = JSON.stringify(outputData)\n\t\t\tif (lessonDetails.data?.lesson) {\n\t\t\t\teditCurrentLesson()\n\t\t\t} else {\n\t\t\t\tcreateNewLesson()\n\t\t\t}\n\t\t})\n\t})\n}\n\nconst createNewLesson = () => {\n\tnewLessonResource.submit(\n\t\t{},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\treturn validateLesson()\n\t\t\t},\n\t\t\tonSuccess(data) {\n\t\t\t\tlessonReference.submit(\n\t\t\t\t\t{ lesson: data.name },\n\t\t\t\t\t{\n\t\t\t\t\t\tonSuccess() {\n\t\t\t\t\t\t\tif (user.data?.is_system_manager)\n\t\t\t\t\t\t\t\tupdateOnboardingStep('create_first_lesson')\n\n\t\t\t\t\t\t\tcapture('lesson_created')\n\t\t\t\t\t\t\ttoast.success(__('Lesson created successfully'))\n\t\t\t\t\t\t\tlessonDetails.reload()\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.messages?.[0] || err)\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst editCurrentLesson = () => {\n\teditLesson.submit(\n\t\t{\n\t\t\tlesson: lessonDetails.data.lesson.name,\n\t\t},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\treturn validateLesson()\n\t\t\t},\n\t\t\tonSuccess() {\n\t\t\t\tshowSuccessMessage\n\t\t\t\t\t? toast.success(__('Lesson updated successfully'))\n\t\t\t\t\t: ''\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\ttoast.error(err.message)\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst validateLesson = () => {\n\tif (!lesson.title) {\n\t\treturn 'Title is required'\n\t}\n\tif (!lesson.content) {\n\t\treturn 'Content is required'\n\t}\n}\n\nconst breadcrumbs = computed(() => {\n\tlet crumbs = [\n\t\t{\n\t\t\tlabel: 'Courses',\n\t\t\troute: { name: 'Courses' },\n\t\t},\n\t\t{\n\t\t\tlabel: lessonDetails.data?.course_title,\n\t\t\troute: { name: 'CourseForm', params: { courseName: props.courseName } },\n\t\t},\n\t]\n\n\tif (lessonDetails?.data?.lesson) {\n\t\tcrumbs.push({\n\t\t\tlabel: lessonDetails.data.lesson.title,\n\t\t\troute: {\n\t\t\t\tname: 'Lesson',\n\t\t\t\tparams: {\n\t\t\t\t\tcourseName: props.courseName,\n\t\t\t\t\tchapterNumber: props.chapterNumber,\n\t\t\t\t\tlessonNumber: props.lessonNumber,\n\t\t\t\t},\n\t\t\t},\n\t\t})\n\t}\n\tcrumbs.push({\n\t\tlabel: lessonDetails?.data?.lesson ? 'Edit Lesson' : 'Create Lesson',\n\t\troute: {\n\t\t\tname: 'LessonForm',\n\t\t\tparams: {\n\t\t\t\tcourseName: props.courseName,\n\t\t\t\tchapterNumber: props.chapterNumber,\n\t\t\t\tlessonNumber: props.lessonNumber,\n\t\t\t},\n\t\t},\n\t})\n\treturn crumbs\n})\n\nusePageMeta(() => {\n\treturn {\n\t\ttitle: lessonDetails?.data?.lesson\n\t\t\t? lessonDetails.data.lesson.title\n\t\t\t: 'New Lesson',\n\t\ticon: brand.favicon,\n\t}\n})\n</script>\n<style>\n.embed-tool__caption,\n.cdx-simple-image__caption {\n\tdisplay: none;\n}\n\n.ce-block__content {\n\tmax-width: none;\n}\n\n.codex-editor--narrow .ce-toolbar__actions {\n\tright: 100%;\n}\n\n.ce-toolbar__content {\n\tmax-width: none;\n}\n\n.codeBoxHolder {\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: flex-start;\n\talign-items: flex-start;\n}\n\n.codeBoxTextArea {\n\twidth: 100%;\n\tmin-height: 30px;\n\tpadding: 10px;\n\tborder-radius: 2px 2px 2px 0;\n\tborder: none !important;\n\toutline: none !important;\n\tfont: 14px monospace;\n}\n\n.codeBoxSelectDiv {\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: flex-start;\n\talign-items: flex-start;\n\tposition: relative;\n}\n\n.codeBoxSelectInput {\n\tborder-radius: 0 0 20px 2px;\n\tpadding: 2px 26px;\n\tpadding-top: 0;\n\tpadding-right: 0;\n\ttext-align: left;\n\tcursor: pointer;\n\tborder: none !important;\n\toutline: none !important;\n}\n\n.codeBoxSelectDropIcon {\n\tposition: absolute !important;\n\tleft: 10px !important;\n\tbottom: 0 !important;\n\twidth: unset !important;\n\theight: unset !important;\n\tfont-size: 16px !important;\n}\n\n.codeBoxSelectPreview {\n\tdisplay: none;\n\tflex-direction: column;\n\tjustify-content: flex-start;\n\talign-items: flex-start;\n\tborder-radius: 2px;\n\tbox-shadow: 0 3px 15px -3px rgba(13, 20, 33, 0.13);\n\tposition: absolute;\n\ttop: 100%;\n\tmargin: 5px 0;\n\tmax-height: 30vh;\n\toverflow-x: hidden;\n\toverflow-y: auto;\n\tz-index: 10000;\n}\n\n.codeBoxSelectItem {\n\twidth: 100%;\n\tpadding: 5px 20px;\n\tmargin: 0;\n\tcursor: pointer;\n}\n\n.codeBoxSelectedItem {\n\tbackground-color: lightblue !important;\n}\n\n.codeBoxShow {\n\tdisplay: flex !important;\n}\n\n.dark {\n\tcolor: #abb2bf;\n\tbackground-color: #282c34;\n}\n\n.light {\n\tcolor: #383a42;\n\tbackground-color: #fafafa;\n}\n\n.codeBoxTextArea {\n\tline-height: 1.7;\n}\n\n.prose :where(pre):not(:where([class~='not-prose'], [class~='not-prose'] *)) {\n\toverflow-x: unset;\n}\n\niframe {\n\tborder: none !important;\n}\n\n.tc-table {\n\tborder-left: 1px solid #e8e8eb;\n}\n\n.ce-toolbox__button[data-tool='markdown'] {\n\tdisplay: none !important;\n}\n\n.ce-popover-item[data-item-name='markdown'] {\n\tdisplay: none !important;\n}\n\n.plyr__volume input[type='range'] {\n\tdisplay: none;\n}\n\n.plyr__control--overlaid {\n\tbackground: radial-gradient(\n\t\tcircle,\n\t\trgba(0, 0, 0, 0.4) 0%,\n\t\trgba(0, 0, 0, 0.5) 50%\n\t);\n}\n\n.plyr__control:hover {\n\tbackground: none;\n}\n\n.plyr--video {\n\tborder: 1px solid theme('colors.gray.200');\n\tborder-radius: 8px;\n}\n\n:root {\n\t--plyr-range-fill-background: white;\n\t--plyr-video-control-background-hover: transparent;\n}\n</style>\n"],"names":["show","_useModel","__props","props","file","computed","showExplanation","ref","type","title","contentMap","openHelpDialog","contentType","brand","sessionStore","editor","instructorEditor","user","inject","openInstructorEditor","updateOnboardingStep","useOnboarding","autoSaveInterval","showSuccessMessage","onMounted","_a","_b","capture","renderEditor","keyboardShortcut","enablePlyr","holder","EditorJS","getEditorTools","api","event","lesson","reactive","lessonDetails","createResource","data","key","addLessonContent","addInstructorNotes","enableAutoSave","blocks","convertToJSON","saveLesson","onBeforeUnmount","newLessonResource","values","editLesson","lessonReference","lessonData","youtubeID","block","quiz","video","audio","pdf","embed","image","level","outputData","editCurrentLesson","createNewLesson","validateLesson","toast","err","breadcrumbs","crumbs","_c","usePageMeta"],"mappings":"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"}