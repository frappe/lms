import{i as B,z as L,s as M,A as d,L as R,o as A,b as c,u as I,e as v,f as u,g as l,h as n,l as t,n as _,p as b,t as i,_ as V,q as r,j as k,k as G,ag as H,b6 as W,b7 as X,b8 as K,b9 as Q,aG as Y,H as j}from"./index-D24HXhLT.js";import{_ as Z}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-DRN2bHzK.js";const ee={class:""},oe={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},ae={class:"py-5"},le={class:"container border-b mb-4 pb-5"},se={class:"text-lg font-semibold mb-4"},te={class:"grid grid-cols-2 gap-5"},ne={class:"space-y-4"},ie={class:"space-y-4"},re={class:"container border-b mb-4 pb-5"},me={class:"text-lg font-semibold mb-4"},de={class:"grid grid-cols-2 gap-5"},ue={class:"block text-ink-gray-5 text-xs mb-1 mt-4"},be={class:"mb-4"},pe={key:1,class:""},ce={class:"flex items-center"},_e={class:"border rounded-md p-2 mr-2"},ye={class:"flex flex-col"},ge={class:"text-sm text-ink-gray-4 mt-1"},fe={class:"container mt-4"},ve={class:"block text-ink-gray-5 text-xs mb-1"},je={__name:"JobForm",props:{jobName:{type:String,default:"new"}},setup(y){const w=B("$user"),g=L(),{brand:C}=M(),m=y,J=d({url:"frappe.client.insert",makeParams(e){var o;return{doc:{doctype:"Job Opportunity",company_logo:(o=a.image)==null?void 0:o.file_url,...a}}}}),x=d({url:"frappe.client.set_value",makeParams(e){return{doctype:"Job Opportunity",name:m.jobName,fieldname:{company_logo:a.image.file_url,...a}}}}),p=d({url:"frappe.client.get",makeParams(e){return{doctype:"Job Opportunity",name:m.jobName}},onSuccess(e){Object.keys(e).forEach(o=>{Object.hasOwn(a,o)&&(a[o]=e[o])}),e.company_logo&&N.reload({image:e.company_logo})}}),N=d({url:"lms.lms.api.get_file_info",makeParams(e){return{file_url:e.image}},auto:!1,onSuccess(e){a.image=e}}),a=R({job_title:"",location:"",country:"",type:"Full Time",status:"Open",company_name:"",company_website:"",image:null,description:"",company_email_address:""});A(()=>{w.data||(window.location.href="/login"),m.jobName!="new"&&p.reload()});const F=()=>{p.data?T():S()},S=()=>{J.submit({},{onSuccess(e){g.push({name:"JobDetail",params:{job:e.name}})},onError(e){var o;j.error(((o=e.messages)==null?void 0:o[0])||e)}})},T=()=>{x.submit({},{onSuccess(e){g.push({name:"JobDetail",params:{job:e.name}})},onError(e){var o;j.error(((o=e.messages)==null?void 0:o[0])||e)}})},U=e=>{a.image=e},O=()=>{a.image=null},q=e=>{let o=e.name.split(".").pop().toLowerCase();if(!["jpg","jpeg","png"].includes(o))return"Only image file is allowed."},D=c(()=>[{label:"Full Time",value:"Full Time"},{label:"Part Time",value:"Part Time"},{label:"Contract",value:"Contract"},{label:"Freelance",value:"Freelance"}]),$=c(()=>[{label:"Open",value:"Open"},{label:"Closed",value:"Closed"}]),E=c(()=>[{label:"Jobs",route:{name:"Jobs"}},{label:m.jobName=="new"?"New Job":"Edit Job",route:{name:"JobForm"}}]);return I(()=>{var e;return{title:m.jobName=="new"?"New Job":(e=p.data)==null?void 0:e.title,icon:C.favicon}}),(e,o)=>{const P=H;return u(),v("div",ee,[l("header",oe,[n(t(Z),{items:E.value},null,8,["items"]),n(t(V),{variant:"solid",onClick:o[0]||(o[0]=s=>F())},{default:_(()=>[b(i(e.__("Save")),1)]),_:1})]),l("div",ae,[l("div",le,[l("div",se,i(e.__("Job Details")),1),l("div",te,[l("div",ne,[n(t(r),{modelValue:a.job_title,"onUpdate:modelValue":o[1]||(o[1]=s=>a.job_title=s),label:e.__("Title"),required:!0},null,8,["modelValue","label"]),n(t(r),{modelValue:a.type,"onUpdate:modelValue":o[2]||(o[2]=s=>a.type=s),label:e.__("Type"),type:"select",options:D.value,required:!0},null,8,["modelValue","label","options"])]),l("div",ie,[n(t(r),{modelValue:a.location,"onUpdate:modelValue":o[3]||(o[3]=s=>a.location=s),label:e.__("City"),required:!0},null,8,["modelValue","label"]),n(P,{modelValue:a.country,"onUpdate:modelValue":o[4]||(o[4]=s=>a.country=s),doctype:"Country",label:e.__("Country"),required:!0},null,8,["modelValue","label"]),y.jobName!="new"?(u(),k(t(r),{key:0,modelValue:a.status,"onUpdate:modelValue":o[5]||(o[5]=s=>a.status=s),label:e.__("Status"),type:"select",options:$.value,required:!0},null,8,["modelValue","label","options"])):G("",!0)])])]),l("div",re,[l("div",me,i(e.__("Company Details")),1),l("div",de,[l("div",null,[n(t(r),{modelValue:a.company_name,"onUpdate:modelValue":o[6]||(o[6]=s=>a.company_name=s),label:e.__("Company Name"),class:"mb-4",required:!0},null,8,["modelValue","label"]),n(t(r),{modelValue:a.company_website,"onUpdate:modelValue":o[7]||(o[7]=s=>a.company_website=s),label:e.__("Company Website"),required:!0},null,8,["modelValue","label"])]),l("div",null,[n(t(r),{modelValue:a.company_email_address,"onUpdate:modelValue":o[8]||(o[8]=s=>a.company_email_address=s),label:e.__("Company Email Address"),class:"mb-4",required:!0},null,8,["modelValue","label"]),l("label",ue,[b(i(e.__("Company Logo"))+" ",1),o[12]||(o[12]=l("span",{class:"text-ink-red-3"},"*",-1))]),a.image?(u(),v("div",pe,[l("div",ce,[l("div",_e,[n(t(X),{class:"h-5 w-5 stroke-1.5 text-ink-gray-7"})]),l("div",ye,[l("span",null,i(a.image.file_name),1),l("span",ge,i(t(K)(a.image.file_size)),1)]),n(t(Q),{onClick:o[10]||(o[10]=s=>O()),class:"bg-surface-gray-3 rounded-md cursor-pointer stroke-1.5 w-5 h-5 p-1 ml-4"})])])):(u(),k(t(W),{key:0,fileTypes:["image/*"],validateFile:q,onSuccess:o[9]||(o[9]=s=>U(s))},{default:_(({file:s,progress:h,uploading:f,openFileSelector:z})=>[l("div",be,[n(t(V),{onClick:z,loading:f},{default:_(()=>[b(i(f?`Uploading ${h}%`:"Upload an image"),1)]),_:2},1032,["onClick","loading"])])]),_:1}))])])]),l("div",fe,[l("label",ve,[b(i(e.__("Description"))+" ",1),o[13]||(o[13]=l("span",{class:"text-ink-red-3"},"*",-1))]),n(t(Y),{content:a.description,onChange:o[11]||(o[11]=s=>a.description=s),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem] mb-4"},null,8,["content"])])])])}}};export{je as default};
//# sourceMappingURL=JobForm-BGPn4luF.js.map
