{"version":3,"file":"AssignmentSubmissionList-ChWxKy1K.js","sources":["../../../../frontend/src/pages/AssignmentSubmissionList.vue"],"sourcesContent":["<template>\n\t<header\n\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n\t>\n\t\t<Breadcrumbs :items=\"breadcrumbs\" />\n\t</header>\n\t<div class=\"md:w-3/4 md:mx-auto py-5 mx-5\">\n\t\t<div class=\"grid grid-cols-3 gap-5 mb-5\">\n\t\t\t<Link\n\t\t\t\tdoctype=\"LMS Assignment\"\n\t\t\t\tv-model=\"assignmentID\"\n\t\t\t\t:placeholder=\"__('Assignment')\"\n\t\t\t/>\n\t\t\t<Link doctype=\"User\" v-model=\"member\" :placeholder=\"__('Member')\" />\n\t\t\t<FormControl\n\t\t\t\tv-model=\"status\"\n\t\t\t\ttype=\"select\"\n\t\t\t\t:options=\"statusOptions\"\n\t\t\t\t:placeholder=\"__('Status')\"\n\t\t\t/>\n\t\t</div>\n\t\t<ListView\n\t\t\tv-if=\"submissions.loading || submissions.data?.length\"\n\t\t\t:columns=\"submissionColumns\"\n\t\t\t:rows=\"submissions.data\"\n\t\t\trowKey=\"name\"\n\t\t>\n\t\t\t<ListHeader\n\t\t\t\tclass=\"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2\"\n\t\t\t>\n\t\t\t\t<ListHeaderItem :item=\"item\" v-for=\"item in submissionColumns\" />\n\t\t\t</ListHeader>\n\t\t\t<ListRows>\n\t\t\t\t<router-link\n\t\t\t\t\tv-for=\"row in submissions.data\"\n\t\t\t\t\t:to=\"{\n\t\t\t\t\t\tname: 'AssignmentSubmission',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tassignmentID: row.assignment,\n\t\t\t\t\t\t\tsubmissionName: row.name,\n\t\t\t\t\t\t},\n\t\t\t\t\t}\"\n\t\t\t\t>\n\t\t\t\t\t<ListRow :row=\"row\">\n\t\t\t\t\t\t<template #default=\"{ column, item }\">\n\t\t\t\t\t\t\t<ListRowItem :item=\"row[column.key]\" :align=\"column.align\">\n\t\t\t\t\t\t\t\t<div v-if=\"column.key == 'status'\">\n\t\t\t\t\t\t\t\t\t<Badge :theme=\"getStatusTheme(row[column.key])\">\n\t\t\t\t\t\t\t\t\t\t{{ row[column.key] }}\n\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t\t\t\t{{ row[column.key] }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</ListRowItem>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</ListRow>\n\t\t\t\t</router-link>\n\t\t\t</ListRows>\n\t\t</ListView>\n\t\t<div\n\t\t\tv-else\n\t\t\tclass=\"text-center p-5 text-ink-gray-5 mt-52 w-3/4 md:w-1/2 mx-auto space-y-2\"\n\t\t>\n\t\t\t<Pencil class=\"size-8 mx-auto stroke-1 text-ink-gray-4\" />\n\t\t\t<div class=\"text-xl font-medium\">\n\t\t\t\t{{ __('No submissions') }}\n\t\t\t</div>\n\t\t\t<div class=\"leading-5\">\n\t\t\t\t{{ __('There are no submissions for this assignment.') }}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tBadge,\n\tBreadcrumbs,\n\tcreateListResource,\n\tFormControl,\n\tListView,\n\tListHeader,\n\tListHeaderItem,\n\tListRows,\n\tListRow,\n\tListRowItem,\n\tusePageMeta,\n} from 'frappe-ui'\nimport { computed, inject, onMounted, ref, watch } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { Pencil } from 'lucide-vue-next'\nimport { sessionStore } from '../stores/session'\nimport Link from '@/components/Controls/Link.vue'\n\nconst user = inject('$user')\nconst dayjs = inject('$dayjs')\nconst { brand } = sessionStore()\nconst router = useRouter()\nconst assignmentID = ref('')\nconst member = ref('')\nconst status = ref('')\n\nonMounted(() => {\n\tif (!user.data?.is_instructor && !user.data?.is_moderator) {\n\t\trouter.push({ name: 'Courses' })\n\t}\n\tassignmentID.value = router.currentRoute.value.query.assignmentID\n\tmember.value = router.currentRoute.value.query.member\n\tstatus.value = router.currentRoute.value.query.status\n\treloadSubmissions()\n})\n\nconst getAssignmentFilters = () => {\n\tlet filters = {}\n\tif (assignmentID.value) {\n\t\tfilters.assignment = assignmentID.value\n\t}\n\tif (member.value) {\n\t\tfilters.member = member.value\n\t}\n\tif (status.value) {\n\t\tfilters.status = status.value\n\t}\n\treturn filters\n}\n\nconst submissions = createListResource({\n\tdoctype: 'LMS Assignment Submission',\n\tfields: [\n\t\t'name',\n\t\t'assignment',\n\t\t'assignment_title',\n\t\t'member_name',\n\t\t'creation',\n\t\t'status',\n\t],\n\torderBy: 'creation desc',\n\ttransform(data) {\n\t\treturn data.map((row) => {\n\t\t\treturn {\n\t\t\t\t...row,\n\t\t\t\tcreation: dayjs(row.creation).fromNow(),\n\t\t\t}\n\t\t})\n\t},\n})\n\n// watch changes in assignmentID, member, and status and if changes in any then reload submissions. Also update the url query params for the same\nwatch([assignmentID, member, status], () => {\n\trouter.push({\n\t\tquery: {\n\t\t\tassignmentID: assignmentID.value,\n\t\t\tmember: member.value,\n\t\t\tstatus: status.value,\n\t\t},\n\t})\n\treloadSubmissions()\n})\n\nconst reloadSubmissions = () => {\n\tsubmissions.update({\n\t\tfilters: getAssignmentFilters(),\n\t})\n\tsubmissions.reload()\n}\n\nconst submissionColumns = computed(() => {\n\treturn [\n\t\t{\n\t\t\tlabel: 'Member',\n\t\t\tkey: 'member_name',\n\t\t\twidth: 1,\n\t\t},\n\t\t{\n\t\t\tlabel: 'Assignment',\n\t\t\tkey: 'assignment_title',\n\t\t\twidth: 2,\n\t\t},\n\t\t{\n\t\t\tlabel: 'Submitted',\n\t\t\tkey: 'creation',\n\t\t\twidth: 1,\n\t\t\talign: 'left',\n\t\t},\n\t\t{\n\t\t\tlabel: 'Status',\n\t\t\tkey: 'status',\n\t\t\twidth: 1,\n\t\t\talign: 'center',\n\t\t},\n\t]\n})\n\nconst statusOptions = computed(() => {\n\treturn [\n\t\t{ label: '', value: '' },\n\t\t{ label: 'Pass', value: 'Pass' },\n\t\t{ label: 'Fail', value: 'Fail' },\n\t\t{ label: 'Not Graded', value: 'Not Graded' },\n\t]\n})\n\nconst getStatusTheme = (status) => {\n\tif (status === 'Pass') {\n\t\treturn 'green'\n\t} else if (status === 'Not Graded') {\n\t\treturn 'blue'\n\t} else {\n\t\treturn 'red'\n\t}\n}\n\nconst breadcrumbs = computed(() => {\n\treturn [\n\t\t{\n\t\t\tlabel: 'Assignment Submissions',\n\t\t},\n\t]\n})\n\nusePageMeta(() => {\n\treturn {\n\t\ttitle: __('Assignment Submissions'),\n\t\ticon: brand.favicon,\n\t}\n})\n</script>\n"],"names":["user","inject","dayjs","brand","sessionStore","router","useRouter","assignmentID","ref","member","status","onMounted","_a","_b","reloadSubmissions","getAssignmentFilters","filters","submissions","createListResource","data","row","watch","submissionColumns","computed","statusOptions","getStatusTheme","breadcrumbs","usePageMeta"],"mappings":"yuBA8FA,MAAMA,EAAOC,EAAO,OAAO,EACrBC,EAAQD,EAAO,QAAQ,EACvB,CAAE,MAAAE,CAAO,EAAGC,EAAY,EACxBC,EAASC,EAAS,EAClBC,EAAeC,EAAI,EAAE,EACrBC,EAASD,EAAI,EAAE,EACfE,EAASF,EAAI,EAAE,EAErBG,EAAU,IAAM,SACX,GAACC,EAAAZ,EAAK,OAAL,MAAAY,EAAW,gBAAiB,GAACC,EAAAb,EAAK,OAAL,MAAAa,EAAW,eAC5CR,EAAO,KAAK,CAAE,KAAM,SAAW,CAAA,EAEhCE,EAAa,MAAQF,EAAO,aAAa,MAAM,MAAM,aACrDI,EAAO,MAAQJ,EAAO,aAAa,MAAM,MAAM,OAC/CK,EAAO,MAAQL,EAAO,aAAa,MAAM,MAAM,OAC/CS,EAAiB,CAClB,CAAC,EAED,MAAMC,EAAuB,IAAM,CAClC,IAAIC,EAAU,CAAA,EACd,OAAIT,EAAa,QAChBS,EAAQ,WAAaT,EAAa,OAE/BE,EAAO,QACVO,EAAQ,OAASP,EAAO,OAErBC,EAAO,QACVM,EAAQ,OAASN,EAAO,OAElBM,CACR,EAEMC,EAAcC,EAAmB,CACtC,QAAS,4BACT,OAAQ,CACP,OACA,aACA,mBACA,cACA,WACA,QACA,EACD,QAAS,gBACT,UAAUC,EAAM,CACf,OAAOA,EAAK,IAAKC,IACT,CACN,GAAGA,EACH,SAAUlB,EAAMkB,EAAI,QAAQ,EAAE,QAAS,CAC3C,EACG,CACD,CACF,CAAC,EAGDC,EAAM,CAACd,EAAcE,EAAQC,CAAM,EAAG,IAAM,CAC3CL,EAAO,KAAK,CACX,MAAO,CACN,aAAcE,EAAa,MAC3B,OAAQE,EAAO,MACf,OAAQC,EAAO,KACf,CACD,CAAA,EACDI,EAAiB,CAClB,CAAC,EAED,MAAMA,EAAoB,IAAM,CAC/BG,EAAY,OAAO,CAClB,QAASF,EAAsB,CAC/B,CAAA,EACDE,EAAY,OAAM,CACnB,EAEMK,EAAoBC,EAAS,IAC3B,CACN,CACC,MAAO,SACP,IAAK,cACL,MAAO,CACP,EACD,CACC,MAAO,aACP,IAAK,mBACL,MAAO,CACP,EACD,CACC,MAAO,YACP,IAAK,WACL,MAAO,EACP,MAAO,MACP,EACD,CACC,MAAO,SACP,IAAK,SACL,MAAO,EACP,MAAO,QACP,CACH,CACC,EAEKC,EAAgBD,EAAS,IACvB,CACN,CAAE,MAAO,GAAI,MAAO,EAAI,EACxB,CAAE,MAAO,OAAQ,MAAO,MAAQ,EAChC,CAAE,MAAO,OAAQ,MAAO,MAAQ,EAChC,CAAE,MAAO,aAAc,MAAO,YAAc,CAC9C,CACC,EAEKE,EAAkBf,GACnBA,IAAW,OACP,QACGA,IAAW,aACd,OAEA,MAIHgB,EAAcH,EAAS,IACrB,CACN,CACC,MAAO,wBACP,CACH,CACC,EAED,OAAAI,EAAY,KACJ,CACN,MAAO,GAAG,wBAAwB,EAClC,KAAMxB,EAAM,OACd,EACC"}